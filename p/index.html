<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Rc-u1 ÈáëÁâå Á≠æÂà∞È¢ò
Rc-u2 Âá∫Èô¢ ÊÄùË∑ØÔºöÁî®Êï∞ÁªÑÊàñËÄÖÁªìÊûÑ‰ΩìÊ®°ÊãüÂç≥ÂèØÔºå‰ΩÜËµõ‰∫ãÂ±ÖÁÑ∂Âøò‰∫ÜÂ¶ÇÊûúÊòØÂ∑≤Áü•Á≠âÁ∫ßÁöÑÈ•ÆÊñôÔºåÁõ¥Êé•ËæìÂá∫Á≠âÁ∫ßËøôÂè•ËØùÔºåËØØËÆ§‰∏∫Â¶ÇÊûú‰∏Ä‰∏™È•ÆÊñôÂèØ‰ª•Ë¢´ÊâæÂà∞ÊàñËÄÖË¢´Â∑≤ÊúâÁöÑÈ•ÆÊñôÊãÜËß£ÁöÑËØù‰πüÁÆóÔºåÁÑ∂ÂêéÂ∞±Êúâ2‰∏™ÁÇπÊ≤°ACÔºåËÄå‰∏îÊñ∞È•ÆÊñô‰∏çÈúÄË¶ÅÂä†ÂÖ•Âà∞Áé∞ÊúâÁöÑÈ•ÆÊñôÂΩì‰∏≠„ÄÇ
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 #include &amp;lt;iostream&amp;gt; using namespace std; const int N=1007; string a[N]; string b[N]; int main(){ ios::sync_with_stdio(false),cin.tie(0); int n,m; cin&amp;gt;&amp;gt;n&amp;gt;&amp;gt;m; for(int i=1;i&amp;lt;=n;i&#43;&#43;){ string t,v; cin&amp;gt;&amp;gt;t&amp;gt;&amp;gt;v; a[i]=t; b[i]=v; } while(m--){ string p,rate=&amp;#34;&amp;#34;; cin&amp;gt;&amp;gt;p; int cnt=0; int ok=0; for(int i=1;i&amp;lt;=n;i&#43;&#43;){ if(a[i]==p){ rate=b[i]; cout&amp;lt;&amp;lt;rate&amp;lt;&amp;lt;&amp;#34;\n&amp;#34;; ok=1; } } if(ok)continue; for(int i=1;i&amp;lt;=n;i&#43;&#43;){ for(int j=1;j&amp;lt;=n;j&#43;&#43;){ string vv=a[i]&#43;a[j]; if(vv==p){ vv=b[i]&#43;b[j]; rate=vv; cnt&#43;&#43;; } } } if(cnt&amp;gt;1||rate.'>
<title></title>

<link rel='canonical' href='https://Turgen.gitee.io/p/'>

<link rel="stylesheet" href="/scss/style.min.8191399262444ab68b72a18c97392f5349be20a1615d77445be51e974c144cff.css"><meta property='og:title' content=''>
<meta property='og:description' content='Rc-u1 ÈáëÁâå Á≠æÂà∞È¢ò
Rc-u2 Âá∫Èô¢ ÊÄùË∑ØÔºöÁî®Êï∞ÁªÑÊàñËÄÖÁªìÊûÑ‰ΩìÊ®°ÊãüÂç≥ÂèØÔºå‰ΩÜËµõ‰∫ãÂ±ÖÁÑ∂Âøò‰∫ÜÂ¶ÇÊûúÊòØÂ∑≤Áü•Á≠âÁ∫ßÁöÑÈ•ÆÊñôÔºåÁõ¥Êé•ËæìÂá∫Á≠âÁ∫ßËøôÂè•ËØùÔºåËØØËÆ§‰∏∫Â¶ÇÊûú‰∏Ä‰∏™È•ÆÊñôÂèØ‰ª•Ë¢´ÊâæÂà∞ÊàñËÄÖË¢´Â∑≤ÊúâÁöÑÈ•ÆÊñôÊãÜËß£ÁöÑËØù‰πüÁÆóÔºåÁÑ∂ÂêéÂ∞±Êúâ2‰∏™ÁÇπÊ≤°ACÔºåËÄå‰∏îÊñ∞È•ÆÊñô‰∏çÈúÄË¶ÅÂä†ÂÖ•Âà∞Áé∞ÊúâÁöÑÈ•ÆÊñôÂΩì‰∏≠„ÄÇ
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 #include &amp;lt;iostream&amp;gt; using namespace std; const int N=1007; string a[N]; string b[N]; int main(){ ios::sync_with_stdio(false),cin.tie(0); int n,m; cin&amp;gt;&amp;gt;n&amp;gt;&amp;gt;m; for(int i=1;i&amp;lt;=n;i&#43;&#43;){ string t,v; cin&amp;gt;&amp;gt;t&amp;gt;&amp;gt;v; a[i]=t; b[i]=v; } while(m--){ string p,rate=&amp;#34;&amp;#34;; cin&amp;gt;&amp;gt;p; int cnt=0; int ok=0; for(int i=1;i&amp;lt;=n;i&#43;&#43;){ if(a[i]==p){ rate=b[i]; cout&amp;lt;&amp;lt;rate&amp;lt;&amp;lt;&amp;#34;\n&amp;#34;; ok=1; } } if(ok)continue; for(int i=1;i&amp;lt;=n;i&#43;&#43;){ for(int j=1;j&amp;lt;=n;j&#43;&#43;){ string vv=a[i]&#43;a[j]; if(vv==p){ vv=b[i]&#43;b[j]; rate=vv; cnt&#43;&#43;; } } } if(cnt&amp;gt;1||rate.'>
<meta property='og:url' content='https://Turgen.gitee.io/p/'>
<meta property='og:site_name' content='ÁæΩËÇøÁöÑ‰∏™‰∫∫ÂçöÂÆ¢'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' />
<meta name="twitter:title" content="">
<meta name="twitter:description" content="Rc-u1 ÈáëÁâå Á≠æÂà∞È¢ò
Rc-u2 Âá∫Èô¢ ÊÄùË∑ØÔºöÁî®Êï∞ÁªÑÊàñËÄÖÁªìÊûÑ‰ΩìÊ®°ÊãüÂç≥ÂèØÔºå‰ΩÜËµõ‰∫ãÂ±ÖÁÑ∂Âøò‰∫ÜÂ¶ÇÊûúÊòØÂ∑≤Áü•Á≠âÁ∫ßÁöÑÈ•ÆÊñôÔºåÁõ¥Êé•ËæìÂá∫Á≠âÁ∫ßËøôÂè•ËØùÔºåËØØËÆ§‰∏∫Â¶ÇÊûú‰∏Ä‰∏™È•ÆÊñôÂèØ‰ª•Ë¢´ÊâæÂà∞ÊàñËÄÖË¢´Â∑≤ÊúâÁöÑÈ•ÆÊñôÊãÜËß£ÁöÑËØù‰πüÁÆóÔºåÁÑ∂ÂêéÂ∞±Êúâ2‰∏™ÁÇπÊ≤°ACÔºåËÄå‰∏îÊñ∞È•ÆÊñô‰∏çÈúÄË¶ÅÂä†ÂÖ•Âà∞Áé∞ÊúâÁöÑÈ•ÆÊñôÂΩì‰∏≠„ÄÇ
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 #include &amp;lt;iostream&amp;gt; using namespace std; const int N=1007; string a[N]; string b[N]; int main(){ ios::sync_with_stdio(false),cin.tie(0); int n,m; cin&amp;gt;&amp;gt;n&amp;gt;&amp;gt;m; for(int i=1;i&amp;lt;=n;i&#43;&#43;){ string t,v; cin&amp;gt;&amp;gt;t&amp;gt;&amp;gt;v; a[i]=t; b[i]=v; } while(m--){ string p,rate=&amp;#34;&amp;#34;; cin&amp;gt;&amp;gt;p; int cnt=0; int ok=0; for(int i=1;i&amp;lt;=n;i&#43;&#43;){ if(a[i]==p){ rate=b[i]; cout&amp;lt;&amp;lt;rate&amp;lt;&amp;lt;&amp;#34;\n&amp;#34;; ok=1; } } if(ok)continue; for(int i=1;i&amp;lt;=n;i&#43;&#43;){ for(int j=1;j&amp;lt;=n;j&#43;&#43;){ string vv=a[i]&#43;a[j]; if(vv==p){ vv=b[i]&#43;b[j]; rate=vv; cnt&#43;&#43;; } } } if(cnt&amp;gt;1||rate.">
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="ÂàáÊç¢ËèúÂçï">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_huc4e51df8c39af0607aedd524a1a8991b_315391_300x0_resize_box_3.png" width="300"
                            height="371" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üç•</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">ÁæΩËÇøÁöÑ‰∏™‰∫∫ÂçöÂÆ¢</a></h1>
            <h2 class="site-description">ÊÑüË∞¢ÊÇ®ÁöÑÈòÖËØªÂíåÊîØÊåÅ„ÄÇ</h2>
        </div>
    </header><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' target="_blank">
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>‰∏ªÈ°µ</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>ÊöóËâ≤Ê®°Âºè</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ÁõÆÂΩï</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#xunity-auto-translator">XUnity Auto Translator</a>
      <ul>
        <li><a href="#index">Index</a></li>
        <li><a href="#introduction">Introduction</a></li>
        <li><a href="#plugin-frameworks">Plugin Frameworks</a></li>
        <li><a href="#installation">Installation</a>
          <ul>
            <li><a href="#standalone-installation-reipatcher">Standalone Installation (ReiPatcher)</a></li>
            <li><a href="#bepinex-5x-plugin">BepInEx (5.x) Plugin</a></li>
            <li><a href="#ipa-plugin">IPA Plugin</a></li>
            <li><a href="#unityinjector-plugin">UnityInjector Plugin</a></li>
          </ul>
        </li>
        <li><a href="#key-mapping">Key Mapping</a></li>
        <li><a href="#translators">Translators</a>
          <ul>
            <li><a href="#about-authenticated-translators">About Authenticated Translators</a></li>
            <li><a href="#spam-prevention">Spam Prevention</a></li>
          </ul>
        </li>
        <li><a href="#text-frameworks">Text Frameworks</a></li>
        <li><a href="#configuration">Configuration</a>
          <ul>
            <li><a href="#behaviour-configuration-explanation">Behaviour Configuration Explanation</a>
              <ul>
                <li><a href="#whitespace-handling">Whitespace Handling</a></li>
                <li><a href="#text-pre-processing">Text pre-processing</a></li>
                <li><a href="#ui-resizing">UI Resizing</a></li>
                <li><a href="#reducing-translation-requests">Reducing Translation Requests</a></li>
                <li><a href="#romaji-translation">Romaji &rsquo;translation&rsquo;</a></li>
                <li><a href="#monomod-hooks">MonoMod Hooks</a></li>
                <li><a href="#other-options">Other Options</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#frequently-asked-questions">Frequently Asked Questions</a></li>
        <li><a href="#translating-mods">Translating Mods</a></li>
        <li><a href="#manual-translations">Manual Translations</a>
          <ul>
            <li><a href="#substitutions">Substitutions</a></li>
            <li><a href="#regex-usage">Regex Usage</a>
              <ul>
                <li><a href="#standard-regex-translation">Standard Regex Translation</a></li>
                <li><a href="#splitter-regex">Splitter Regex</a></li>
              </ul>
            </li>
            <li><a href="#ui-font-resizing">UI Font Resizing</a></li>
            <li><a href="#translation-scoping">Translation Scoping</a></li>
            <li><a href="#text-lookup-and-whitespace-handling">Text Lookup and Whitespace Handling</a></li>
            <li><a href="#resource-redirection">Resource Redirection</a></li>
          </ul>
        </li>
        <li><a href="#regarding-redistribution">Regarding Redistribution</a></li>
        <li><a href="#texture-translation">Texture Translation</a>
          <ul>
            <li><a href="#technical-details-about-hash-generation-in-file-names">Technical details about Hash Generation in file names</a></li>
          </ul>
        </li>
        <li><a href="#integrating-with-auto-translator">Integrating with Auto Translator</a>
          <ul>
            <li><a href="#implementing-a-dedicated-translation-component">Implementing a dedicated translation component</a></li>
            <li><a href="#implementing-a-plugin-that-can-query-translations">Implementing a plugin that can query translations</a></li>
            <li><a href="#implementing-a-component-that-the-auto-translator-should-not-interfere-with">Implementing a component that the Auto Translator should not interfere with</a></li>
          </ul>
        </li>
        <li><a href="#implementing-a-translator">Implementing a Translator</a>
          <ul>
            <li><a href="#important-notes-on-implementing-a-translator-based-on-an-online-service">Important Notes on Implementing a Translator based on an Online Service</a></li>
            <li><a href="#how-to">How-To</a></li>
          </ul>
        </li>
        <li><a href="#implementing-a-resource-redirector">Implementing a Resource Redirector</a>
          <ul>
            <li><a href="#asset-loadingloaded-methods">Asset Loading/Loaded Methods</a>
              <ul>
                <li><a href="#asset-loading-methods">Asset Loading Methods</a></li>
                <li><a href="#asset-loaded-methods">Asset Loaded Methods</a></li>
              </ul>
            </li>
            <li><a href="#resource-load-methods">Resource Load Methods</a>
              <ul>
                <li><a href="#resource-loaded-methods">Resource Loaded Methods</a></li>
              </ul>
            </li>
            <li><a href="#assetbundle-load-methods">AssetBundle Load Methods</a>
              <ul>
                <li><a href="#assetbundle-synchrous-load-methods">AssetBundle Synchrous Load Methods</a></li>
                <li><a href="#assetbundle-asynchrounous-load-methods">AssetBundle Asynchrounous Load Methods</a></li>
              </ul>
            </li>
            <li><a href="#about-recursion">About Recursion</a></li>
            <li><a href="#implementing-an-asset-redirector">Implementing an Asset Redirector</a></li>
            <li><a href="#implemting-an-assetbundle-redirector">Implemting an AssetBundle Redirector</a></li>
            <li><a href="#implementing-an-assetresource-handler-auto-translator">Implementing an Asset/Resource Handler (Auto Translator)</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/"></a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    ÈòÖËØªÊó∂Èïø: 2 ÂàÜÈíü
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="xunity-auto-translator">XUnity Auto Translator</h1>
<h2 id="index">Index</h2>
<ul>
<li><a class="link" href="#introduction" >Introduction</a></li>
<li><a class="link" href="#plugin-frameworks" >Plugin Frameworks</a></li>
<li><a class="link" href="#installation" >Installation</a></li>
<li><a class="link" href="#key-mapping" >Key Mapping</a></li>
<li><a class="link" href="#translators" >Translators</a></li>
<li><a class="link" href="#text-frameworks" >Text Frameworks</a></li>
<li><a class="link" href="#configuration" >Configuration</a></li>
<li><a class="link" href="#frequently-asked-questions" >Frequently Asked Questions</a></li>
<li><a class="link" href="#translating-mods" >Translating Mods</a></li>
<li><a class="link" href="#manual-translations" >Manual Translations</a></li>
<li><a class="link" href="#regarding-redistribution" >Regarding Redistribution</a></li>
<li><a class="link" href="#texture-translation" >Texture Translation</a></li>
<li><a class="link" href="#integrating-with-auto-translator" >Integrating with Auto Translator</a></li>
<li><a class="link" href="#implementing-a-translator" >Implementing a Translator</a></li>
<li><a class="link" href="#implementing-a-resource-redirector" >Implementing a Resource Redirector</a></li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>This is a plugin that is capable of using various online translators to provide on-the-fly translations for various Unity-based games.</p>
<p>It does (obviously) go to the internet, in order to provide the translation, so if you are not comfortable with that, don&rsquo;t use it.</p>
<p>Oh, and it is also capable of doing some basic image loading/dumping. Go to the <a class="link" href="#texture-translation" >Texture Translation</a> section to find out more.</p>
<p>If you intend on redistributing this plugin as part of a translation suite for a game, please read <a class="link" href="#regarding-redistribution" >this section</a> and the section regarding <a class="link" href="#manual-translations" >manual translations</a> so you understand how the plugin operates.</p>
<p>From version 3.0.0 it is possible to implement custom translators. See <a class="link" href="#implementing-a-translator" >this section</a> for more info.</p>
<p>From version 4.0.0 it comes with a resource redirector (version 1.0.0) that enables redirecting resources for any purpose. See more information <a class="link" href="#resource-redirection" >here</a>.</p>
<h2 id="plugin-frameworks">Plugin Frameworks</h2>
<p>The mod can be installed without any external dependencies or as a plugin to the following Plugin Managers/Mod Loaders:</p>
<ul>
<li><a class="link" href="https://github.com/bbepis/BepInEx"  target="_blank" rel="noopener"
    >BepInEx</a> (recommended)</li>
<li><a class="link" href="https://github.com/Eusth/IPA"  target="_blank" rel="noopener"
    >IPA</a></li>
<li>UnityInjector</li>
</ul>
<p>Installation instructions for all methods can be found below.</p>
<h2 id="installation">Installation</h2>
<p>The plugin can be installed in following ways:</p>
<h3 id="standalone-installation-reipatcher">Standalone Installation (ReiPatcher)</h3>
<p>REQUIRES: Nothing, ReiPatcher is provided by this download.</p>
<p><em>VERY IMPORTANT NOTE: Using this method is a certain way to get the plugin working in most Unity games with two simple clicks. Do note that if one of the supported Plugin Managers is used, this installation method should be avoided as it will cause problems.</em></p>
<ol start="0">
<li>Read the <code>VERY IMPORTANT NOTE</code> above.</li>
<li>Download XUnity.AutoTranslator-ReiPatcher-{VERSION}.zip from <a class="link" href="../../releases" >releases</a>.</li>
<li>Extract directly into the game directory, such that &ldquo;SetupReiPatcherAndAutoTranslator.exe&rdquo; is placed alongside other exe files.</li>
<li>Execute &ldquo;SetupReiPatcherAndAutoTranslator.exe&rdquo;. This will setup up ReiPatcher correctly.</li>
<li>Execute the shortcut {GameExeName} (Patch and Run).lnk that was created besides existing executables. This will patch and launch the game.</li>
<li>From now on you can launch the game from the {GameExeName}.exe instead.</li>
<li>Due to various considerations, not all text hooks are enabled by default, so if you find that the game or parts of the game are not being properly translated it may be worth going into the configuration file and enable some of the disabled text frameworks! The configuration file is created when the game is launched.</li>
</ol>
<p>The file structure should like like this</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{GameDirectory}/ReiPatcher/Patches/XUnity.AutoTranslator.Patcher.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/ReiPatcher/ExIni.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/ReiPatcher/Mono.Cecil.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/ReiPatcher/Mono.Cecil.Inject.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/ReiPatcher/Mono.Cecil.Mdb.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/ReiPatcher/Mono.Cecil.Pdb.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/ReiPatcher/Mono.Cecil.Rocks.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/ReiPatcher/ReiPatcher.exe
</span></span><span class="line"><span class="cl">{GameDirectory}/{GameExeName}_Data/Managed/ReiPatcher.exe
</span></span><span class="line"><span class="cl">{GameDirectory}/{GameExeName}_Data/Managed/XUnity.Common.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/{GameExeName}_Data/Managed/XUnity.ResourceRedirector.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/{GameExeName}_Data/Managed/XUnity.AutoTranslator.Plugin.Core.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/{GameExeName}_Data/Managed/XUnity.AutoTranslator.Plugin.ExtProtocol.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/{GameExeName}_Data/Managed/MonoMod.RuntimeDetour.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/{GameExeName}_Data/Managed/MonoMod.Utils.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/{GameExeName}_Data/Managed/Mono.Cecil.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/{GameExeName}_Data/Managed/0Harmony.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/{GameExeName}_Data/Managed/ExIni.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/{GameExeName}_Data/Managed/Translators/{Translator}.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/AutoTranslator/Translation/AnyTranslationFile.txt (these files will be auto generated by plugin!)
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>NOTE:</strong> The <code>Mono.Cecil.dll</code> file placed in the ReiPatcher directory is not the same file as is placed in the Managed directory.</p>
<h3 id="bepinex-5x-plugin">BepInEx (5.x) Plugin</h3>
<p>REQUIRES: <a class="link" href="https://github.com/BepInEx/BepInEx"  target="_blank" rel="noopener"
    >BepInEx plugin manager</a> (follow its installation instructions first!).</p>
<ol>
<li>Download XUnity.AutoTranslator-BepIn-5x-{VERSION}.zip from <a class="link" href="../../releases" >releases</a>.</li>
<li>Extract directly into the game directory, such that the plugin dlls are placed in BepInEx folder.</li>
<li>Launch the game.</li>
<li>Due to various considerations, not all text hooks are enabled by default, so if you find that the game or parts of the game are not being properly translated it may be worth going into the configuration file and enable some of the disabled text frameworks! The configuration file is created when the game is launched.</li>
</ol>
<p>The file structure should like like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{GameDirectory}/BepInEx/core/XUnity.Common.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/BepInEx/plugins/XUnity.ResourceRedirector/XUnity.ResourceRedirector.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/BepInEx/plugins/XUnity.ResourceRedirector/XUnity.ResourceRedirector.BepIn-5x.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/BepInEx/plugins/XUnity.AutoTranslator/XUnity.AutoTranslator.Plugin.Core.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/BepInEx/plugins/XUnity.AutoTranslator/XUnity.AutoTranslator.Plugin.BepIn.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/BepInEx/plugins/XUnity.AutoTranslator/XUnity.AutoTranslator.Plugin.ExtProtocol.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/BepInEx/plugins/XUnity.AutoTranslator/ExIni.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/BepInEx/plugins/XUnity.AutoTranslator/Translators/{Translator}.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/BepInEx/core/MonoMod.RuntimeDetour.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/BepInEx/core/MonoMod.Utils.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/BepInEx/core/Mono.Cecil.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/BepInEx/Translation/AnyTranslationFile.txt (these files will be auto generated by plugin!)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ipa-plugin">IPA Plugin</h3>
<p>REQUIRES: <a class="link" href="https://github.com/Eusth/IPA"  target="_blank" rel="noopener"
    >IPA plugin manager</a> (follow its installation instructions first!).</p>
<ol>
<li>Download XUnity.AutoTranslator-IPA-{VERSION}.zip from <a class="link" href="../../releases" >releases</a>.</li>
<li>Extract directly into the game directory, such that the plugin dlls are placed in Plugins folder.</li>
<li>Launch the game.</li>
<li>Due to various considerations, not all text hooks are enabled by default, so if you find that the game or parts of the game are not being properly translated it may be worth going into the configuration file and enable some of the disabled text frameworks! The configuration file is created when the game is launched.</li>
</ol>
<p>The file structure should like like this</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{GameDirectory}/Plugins/XUnity.Common.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/Plugins/XUnity.ResourceRedirector.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/Plugins/XUnity.AutoTranslator.Plugin.Core.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/Plugins/XUnity.AutoTranslator.Plugin.IPA.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/Plugins/XUnity.AutoTranslator.Plugin.ExtProtocol.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/Plugins/MonoMod.RuntimeDetour.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/Plugins/MonoMod.Utils.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/Plugins/Mono.Cecil.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/Plugins/0Harmony.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/Plugins/ExIni.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/Plugins/Translators/{Translator}.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/Plugins/Translation/AnyTranslationFile.txt (these files will be auto generated by plugin!)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="unityinjector-plugin">UnityInjector Plugin</h3>
<p>REQUIRES: UnityInjector (follow its installation instructions first!).</p>
<ol>
<li>Download XUnity.AutoTranslator-UnityInjector-{VERSION}.zip from <a class="link" href="../../releases" >releases</a>.</li>
<li>Extract directly into the game directory, such that the plugin dlls are placed in UnityInjector folder. <strong>This may not be game root directory!</strong></li>
<li>Launch the game.</li>
<li>Due to various considerations, not all text hooks are enabled by default, so if you find that the game or parts of the game are not being properly translated it may be worth going into the configuration file and enable some of the disabled text frameworks! The configuration file is created when the game is launched.</li>
</ol>
<p>The file structure should like like this</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{GameDirectory}/UnityInjector/XUnity.Common.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/UnityInjector/XUnity.ResourceRedirector.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/UnityInjector/XUnity.AutoTranslator.Plugin.Core.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/UnityInjector/XUnity.AutoTranslator.Plugin.UnityInjector.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/UnityInjector/XUnity.AutoTranslator.Plugin.ExtProtocol.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/UnityInjector/0Harmony.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/UnityInjector/Translators/{Translator}.dll
</span></span><span class="line"><span class="cl">{GameDirectory}/UnityInjector/Config/Translation/AnyTranslationFile.txt (these files will be auto generated by plugin!)
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>NOTE:</strong> MonoMod hooks are not supported with this installation method because an outdated version of <code>Mono.Cecil.dll</code> is being used with Sybaris.</p>
<h2 id="key-mapping">Key Mapping</h2>
<p>The following key inputs are mapped:</p>
<ul>
<li>ALT + 0: Toggle XUnity AutoTranslator UI. (That&rsquo;s a zero, not an O)</li>
<li>ALT + 1: Toggle Translation Aggregator UI.</li>
<li>ALT + T: Alternate between translated and untranslated versions of all texts provided by this plugin.</li>
<li>ALT + R: Reload translation files. Useful if you change the text and texture files on the fly. Not guaranteed to work for all textures.</li>
<li>ALT + U: Manual hooking. The default hooks wont always pick up texts. This will attempt to make lookups manually. Will not hook text components from frameworks not enabled.</li>
<li>ALT + F: If OverrideFont is configured, will toggle between overridden and default font.</li>
<li>ALT + Q: Reboot the plugin if it was shutdown. This will only work if the plugin was shut down due to consecutive errors towards the translation endpoint. Should only be used if you have reason to believe you have remedied the problem (such as changed VPN endpoint etc.) otherwise it will just shut down again.</li>
</ul>
<p>Debugging-only keys:</p>
<ul>
<li>CTRL + ALT + NP9: Simulate synchronous errors</li>
<li>CTRL + ALT + NP8: Simulate asynchronous errors delayed by one second</li>
<li>CTRL + ALT + NP7: Print out loaded scene names and ids to console</li>
<li>CTRL + ALT + NP6: Print out entire GameObject hierarchy to file <code>hierarchy.txt</code></li>
</ul>
<h2 id="translators">Translators</h2>
<p>The supported translators are:</p>
<ul>
<li><a class="link" href="https://anonym.to/?https://translate.google.com/"  target="_blank" rel="noopener"
    >GoogleTranslate</a>, based on the online Google translation service. Does not require authentication.
<ul>
<li>No limitations, but unstable.</li>
</ul>
</li>
<li><a class="link" href="https://anonym.to/?https://translate.google.com/"  target="_blank" rel="noopener"
    >GoogleTranslateCompat</a>, same as the above, except requests are served out-of-process which is needed in some versions of Unity/Mono.
<ul>
<li>No limitations, but unstable.</li>
</ul>
</li>
<li><a class="link" href="https://anonym.to/?https://cloud.google.com/translate/"  target="_blank" rel="noopener"
    >GoogleTranslateLegitimate</a>, based on the Google cloud translation API. Requires an API key.
<ul>
<li>Provides trial period of 1 year with $300 credits. Enough for 15 million characters translations.</li>
</ul>
</li>
<li><a class="link" href="https://anonym.to/?https://www.bing.com/translator"  target="_blank" rel="noopener"
    >BingTranslate</a>, based on the online Bing translation service. Does not require authentication.
<ul>
<li>No limitations, but unstable.</li>
</ul>
</li>
<li><a class="link" href="https://anonym.to/?https://docs.microsoft.com/en-us/azure/cognitive-services/translator/translator-info-overview"  target="_blank" rel="noopener"
    >BingTranslateLegitimate</a>, based on the Azure text translation. Requires an API key.
<ul>
<li>Free up to 2 million characters per month.</li>
</ul>
</li>
<li><a class="link" href="https://anonym.to/?https://papago.naver.com/"  target="_blank" rel="noopener"
    >PapagoTranslate</a>, based on the online Google translation service. Does not require authentication.
<ul>
<li>No limitations, but unstable.</li>
</ul>
</li>
<li><a class="link" href="https://anonym.to/?https://fanyi.baidu.com/"  target="_blank" rel="noopener"
    >BaiduTranslate</a>, based on Baidu translation service. Requires AppId and AppSecret.
<ul>
<li>Not sure on quotas on this one.</li>
</ul>
</li>
<li><a class="link" href="https://anonym.to/?https://tech.yandex.com/translate/"  target="_blank" rel="noopener"
    >YandexTranslate</a>, based on the Yandex translation service. Requires an API key.
<ul>
<li>Free up to 1 million characters per day, but max 10 million characters per month.</li>
</ul>
</li>
<li><a class="link" href="https://anonym.to/?https://cloud.ibm.com/apidocs/language-translator"  target="_blank" rel="noopener"
    >WatsonTranslate</a>, based on IBM&rsquo;s Watson. Requires a URL and an API key.
<ul>
<li>Free up to 1 million characters per month.</li>
</ul>
</li>
<li>LecPowerTranslator15, based on LEC&rsquo;s Power Translator. Does not require authentication, but does require the software installed.
<ul>
<li>No limitations.</li>
</ul>
</li>
<li>ezTrans XP, based on Changsinsoft&rsquo;s japanese-korean translator ezTrans XP. Does not require authentication, but does require the software and <a class="link" href="https://github.com/sokcuri/ehnd"  target="_blank" rel="noopener"
    >Ehnd</a> installed.
<ul>
<li>No limitations.</li>
</ul>
</li>
<li>CustomTranslate. Alternatively you can also specify any custom HTTP url that can be used as a translation endpoint (GET request). This must use the query parameters &ldquo;from&rdquo;, &ldquo;to&rdquo; and &ldquo;text&rdquo; and return only a string with the result (try HTTP without SSL first, as unity-mono often has issues with SSL).
<ul>
<li><em>NOTE: This is a developer-centric option. You cannot simply specify &ldquo;CustomTranslate&rdquo; and expect it to work with any arbitrary translation service you find online. See <a class="link" href="#frequently-asked-questions" >FAQ</a></em></li>
<li>Example Configuration:
<ul>
<li>Endpoint=CustomTranslate</li>
<li>[Custom]</li>
<li>Url=http://my-custom-translation-service.net/translate</li>
</ul>
</li>
<li>Example Request: GET <a class="link" href="http://my-custom-translation-service.net/translate?from=ja&amp;to=en&amp;text="  target="_blank" rel="noopener"
    >http://my-custom-translation-service.net/translate?from=ja&to=en&text=</a>„Åì„Çì„Å´„Å°„ÅØ</li>
<li>Example Response (only body): Hello</li>
<li>Known implementations that can be used with CustomTranslate:
<ul>
<li>ezTrans: <a class="link" href="https://github.com/HelloKS/ezTransWeb"  target="_blank" rel="noopener"
    >https://github.com/HelloKS/ezTransWeb</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><em>NOTE: If you use any of the online translators that does not require some form of authentication, that this plugin may break at any time.</em></p>
<p>Since 3.0.0, you can also implement your own translators. To do so, follow the instruction <a class="link" href="#implementing-a-translator" >here</a>.</p>
<h3 id="about-authenticated-translators">About Authenticated Translators</h3>
<p>If you decide to use an authenticated service <em>do not ever share your key or secret</em>. If you do so by accident, you should revoke it immediately. Most, if not all services provides an option for this.</p>
<p>Also, make sure you monitor the service&rsquo;s request usage/quotas, especially when it is being used with unknown games. This plugin makes no guarantees about how many translation requests will be sent out, although it will attempt to keep the number to a minimum. It does so by using the <a class="link" href="#spam-prevention" >spam prevention mechanisms</a> discussed below.</p>
<h3 id="spam-prevention">Spam Prevention</h3>
<p>The plugin employs the following spam prevention mechanisms:</p>
<ol>
<li>When it sees a new text, it will always wait one second before it queues a translation request, to check if that same text changes. It will not send out any request until the text has not changed for 1 second.</li>
<li>It will never send out more than 8000 requests (max 200 characters each (configurable)) during a single game session.</li>
<li>It will never send out more than 1 request at a time (no concurrency!).</li>
<li>If it detects an increasing number of queued translations (4000), the plugin will shutdown.</li>
<li>If the service returns no result for five consecutive requests, the plugin will shutdown.</li>
<li>If the plugin detects that the game queues translations every frame, the plugin will shutdown after 90 frames.</li>
<li>If the plugin detects text that &ldquo;scrolls&rdquo; into place, the plugin will shutdown. This is detected by inspecting all requests that are queued for translation. ((1) will genenerally prevent this from happening)</li>
<li>If the plugin consistently queues translations every second for more than 60 seconds, the plugin will shutdown.</li>
<li>For the supported languages, each translatable line must pass a symbol check that detects if the line includes characters from the source language.</li>
<li>It will never attempt a translation for a text that is already considered a translation for something else.</li>
<li>All queued translations are kept track of. If two different components that require the same translation and both are queued for translation at the same time, only a single request is sent.</li>
<li>It employs an internal dictionary of manual translations (~2000 in total) for commonly used phrases (Japanese-to-English only) to prevent sending out translation requests for these.</li>
<li>Some endpoints support batching of translations so far fewer requests are sent. This does not increase the total number of translations per session (2).</li>
<li>All translation results are cached in memory and stored on disk to prevent making the same translation request twice.</li>
<li>Due to its spammy nature, any text that comes from an IMGUI component has any numbers found in it templated away (and substituted back in upon translation) to prevent issues in relation to (6).</li>
<li>The plugin will keep a single TCP connection alive towards the translation endpoint. This connection will be gracefully closed if it is not used for 50 seconds.</li>
</ol>
<h2 id="text-frameworks">Text Frameworks</h2>
<p>The following text frameworks are supported.</p>
<ul>
<li><a class="link" href="https://docs.unity3d.com/Manual/UISystem.html"  target="_blank" rel="noopener"
    >UGUI</a></li>
<li><a class="link" href="https://assetstore.unity.com/packages/tools/gui/ngui-next-gen-ui-2413"  target="_blank" rel="noopener"
    >NGUI</a></li>
<li><a class="link" href="https://docs.unity3d.com/Manual/GUIScriptingGuide.html"  target="_blank" rel="noopener"
    >IMGUI</a> (disabled by default)</li>
<li><a class="link" href="http://digitalnativestudios.com/textmeshpro/docs/"  target="_blank" rel="noopener"
    >TextMeshPro</a></li>
<li><a class="link" href="https://docs.unity3d.com/Manual/class-TextMesh.html"  target="_blank" rel="noopener"
    >TextMesh</a> (disabled by default, often text float in 3D space)</li>
<li><a class="link" href="https://github.com/fairygui/FairyGUI-unity"  target="_blank" rel="noopener"
    >FairyGUI for Unity</a></li>
<li><a class="link" href="http://madnesslabo.net/utage/?lang=en"  target="_blank" rel="noopener"
    >Utage (VN Game Engine)</a></li>
</ul>
<h2 id="configuration">Configuration</h2>
<p>The default configuration file, looks as such:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="k">[Service]</span>
</span></span><span class="line"><span class="cl"><span class="na">Endpoint</span><span class="o">=</span><span class="s">GoogleTranslate         ;Endpoint to use. Can be [&#34;GoogleTranslate&#34;, &#34;GoogleTranslateLegitimate&#34;, &#34;BingTranslate&#34;, &#34;BingTranslateLegitimate&#34;, &#34;BaiduTranslate&#34;, &#34;YandexTranslate&#34;, &#34;WatsonTranslate&#34;, &#34;LecPowerTranslator15&#34;, &#34;CustomTranslate&#34;, &#34;&#34;]. If empty, it simply means: Only use cached translations. Additional translators can also be used if downloaded externally.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[General]</span>
</span></span><span class="line"><span class="cl"><span class="na">Language</span><span class="o">=</span><span class="s">en                      ;The language to translate into</span>
</span></span><span class="line"><span class="cl"><span class="na">FromLanguage</span><span class="o">=</span><span class="s">ja                  ;The original language of the game. &#34;auto&#34; is also supported for some endpoints, but it is generally not recommended</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[Files]</span>
</span></span><span class="line"><span class="cl"><span class="na">Directory</span><span class="o">=</span><span class="s">Translation\{Lang}\Text                                   ;Directory to search for cached translation files. Can use placeholder: {GameExeName}, {Lang}</span>
</span></span><span class="line"><span class="cl"><span class="na">OutputFile</span><span class="o">=</span><span class="s">Translation\{Lang}\Text\_AutoGeneratedTranslations.txt   ;File to insert generated translations into. Can use placeholders: {GameExeName}, {Lang}</span>
</span></span><span class="line"><span class="cl"><span class="na">SubstitutionFile</span><span class="o">=</span><span class="s">Translation\{Lang}\Text\_Substitutions.txt         ;File that contains substitution applied before translations. Can use placeholders: {GameExeName}, {Lang}</span>
</span></span><span class="line"><span class="cl"><span class="na">PreprocessorsFile</span><span class="o">=</span><span class="s">Translation\{Lang}\Text\_Preprocessors.txt        ;File that contains preprocessors to be applied before sending a text to a translator. Can use placeholders: {GameExeName}, {Lang}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[TextFrameworks]</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableUGUI</span><span class="o">=</span><span class="s">True                  ;Enable or disable UGUI translation</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableNGUI</span><span class="o">=</span><span class="s">True                  ;Enable or disable NGUI translation</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableTextMeshPro</span><span class="o">=</span><span class="s">True           ;Enable or disable TextMeshPro translation</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableTextMesh</span><span class="o">=</span><span class="s">False             ;Enable or disable TextMesh translation</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableIMGUI</span><span class="o">=</span><span class="s">False                ;Enable or disable IMGUI translation</span>
</span></span><span class="line"><span class="cl"><span class="na">AllowPluginHookOverride</span><span class="o">=</span><span class="s">True     ;Allow other text translation plugins to override this plugin&#39;s hooks</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[Behaviour]</span>
</span></span><span class="line"><span class="cl"><span class="na">MaxCharactersPerTranslation</span><span class="o">=</span><span class="s">200  ;Max characters per text to translate. Max 1000.</span>
</span></span><span class="line"><span class="cl"><span class="na">IgnoreWhitespaceInDialogue</span><span class="o">=</span><span class="s">True  ;Whether or not to ignore whitespace, including newlines, in dialogue keys</span>
</span></span><span class="line"><span class="cl"><span class="na">IgnoreWhitespaceInNGUI</span><span class="o">=</span><span class="s">True      ;Whether or not to ignore whitespace, including newlines, in NGUI</span>
</span></span><span class="line"><span class="cl"><span class="na">MinDialogueChars</span><span class="o">=</span><span class="s">20              ;The length of the text for it to be considered a dialogue</span>
</span></span><span class="line"><span class="cl"><span class="na">ForceSplitTextAfterCharacters</span><span class="o">=</span><span class="s">0  ;Split text into multiple lines once the translated text exceeds this number of characters</span>
</span></span><span class="line"><span class="cl"><span class="na">CopyToClipboard</span><span class="o">=</span><span class="s">False            ;Whether or not to copy hooked texts to clipboard</span>
</span></span><span class="line"><span class="cl"><span class="na">MaxClipboardCopyCharacters</span><span class="o">=</span><span class="s">450   ;Max number of characters to hook to clipboard at a time</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableUIResizing</span><span class="o">=</span><span class="s">True            ;Whether or not the plugin should provide a &#34;best attempt&#34; at resizing UI components upon translation</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableBatching</span><span class="o">=</span><span class="s">True              ;Indicates whether batching of translations should be enabled for supported endpoints</span>
</span></span><span class="line"><span class="cl"><span class="na">UseStaticTranslations</span><span class="o">=</span><span class="s">True       ;Indicates whether or not to use translations from the included static translation cache</span>
</span></span><span class="line"><span class="cl"><span class="na">OverrideFont</span><span class="o">=</span>                    <span class="s">;Overrides the fonts used for texts when updating text components. NOTE: Only works for UGUI</span>
</span></span><span class="line"><span class="cl"><span class="na">OverrideFontTextMeshPro</span><span class="o">=</span>         <span class="s">;Overrides the fonts used for texts when updating text components. NOTE: Only works for TextMeshPro</span>
</span></span><span class="line"><span class="cl"><span class="na">ResizeUILineSpacingScale</span><span class="o">=</span>        <span class="s">;A decimal value that the default line spacing should be scaled by during UI resizing, for example: 0.80. NOTE: Only works for UGUI</span>
</span></span><span class="line"><span class="cl"><span class="na">ForceUIResizing</span><span class="o">=</span><span class="s">True             ;Indicates whether the UI resize behavior should be applied to all UI components regardless of them being translated.</span>
</span></span><span class="line"><span class="cl"><span class="na">IgnoreTextStartingWith</span><span class="o">=</span><span class="s">\u180e;   ;Indicates that the plugin should ignore any strings starting with certain characters. This is a list seperated by &#39;;&#39;.</span>
</span></span><span class="line"><span class="cl"><span class="na">TextGetterCompatibilityMode</span><span class="o">=</span><span class="s">False ;Indicates whether or not to enable &#34;Text Getter Compatibility Mode&#34;. Should only be enabled if required by the game. </span>
</span></span><span class="line"><span class="cl"><span class="na">GameLogTextPaths</span><span class="o">=</span>                <span class="s">;Indicates specific paths for game objects that the game uses as &#34;log components&#34;, where it continuously appends or prepends text to. Requires expert knowledge to setup. This is a list seperated by &#39;;&#39;.</span>
</span></span><span class="line"><span class="cl"><span class="na">RomajiPostProcessing</span><span class="o">=</span><span class="s">ReplaceMacronWithCircumflex;RemoveApostrophes ;Indicates what type of post processing to do on &#39;translated&#39; romaji texts. This can be important in certain games because the font used does not support various diacritics properly. This is a list seperated by &#39;;&#39;. Possible values: [&#34;RemoveAllDiacritics&#34;, &#34;ReplaceMacronWithCircumflex&#34;, &#34;RemoveApostrophes&#34;]</span>
</span></span><span class="line"><span class="cl"><span class="na">TranslationPostProcessing</span><span class="o">=</span><span class="s">ReplaceMacronWithCircumflex ;Indicates what type of post processing to do on translated texts (not romaji). Possible values: [&#34;RemoveAllDiacritics&#34;, &#34;ReplaceMacronWithCircumflex&#34;, &#34;RemoveApostrophes&#34;, &#34;ReplaceWideCharacters&#34;]</span>
</span></span><span class="line"><span class="cl"><span class="na">ForceMonoModHooks</span><span class="o">=</span><span class="s">False          ;Indicates that the plugin must use MonoMod hooks instead of harmony hooks</span>
</span></span><span class="line"><span class="cl"><span class="na">CacheRegexLookups</span><span class="o">=</span><span class="s">False          ;Indicates whether or not results of regex lookups should be output to the specified OutputFile</span>
</span></span><span class="line"><span class="cl"><span class="na">CacheWhitespaceDifferences</span><span class="o">=</span><span class="s">False ;Indicates whether or not whitespace differences should be output to the specified OutputFile</span>
</span></span><span class="line"><span class="cl"><span class="na">CacheRegexPatternResults</span><span class="o">=</span><span class="s">False   ;Indicates whether or not the complete result of regex-splitted translations should be output to the specified OutputFile</span>
</span></span><span class="line"><span class="cl"><span class="na">GenerateStaticSubstitutionTranslations</span><span class="o">=</span><span class="s">False ;Indicates that the plugin should generate translations without variables when using substitutions</span>
</span></span><span class="line"><span class="cl"><span class="na">GeneratePartialTranslations</span><span class="o">=</span><span class="s">False ;Indicates that the plugin should generate partial translations to support text translations as it is &#34;scrolling in&#34;</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableTranslationScoping</span><span class="o">=</span><span class="s">False   ;Indicates the plugin should parse &#39;TARC&#39; directives and scope translations based on these</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableSilentMode</span><span class="o">=</span><span class="s">False           ;Indicates the plugin should not print out success messages in relation to translations</span>
</span></span><span class="line"><span class="cl"><span class="na">BlacklistedIMGUIPlugins</span><span class="o">=</span>         <span class="s">;If an IMGUI window assembly/class/method name contains any of the strings in this list (case insensitive) that UI will not be translated. Requires MonoMod hooks. This is a list seperated by &#39;;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="na">OutputUntranslatableText</span><span class="o">=</span><span class="s">False   ;Indicates if texts that are considered by the plugin to be untranslatable should be output to the specified OutputFile</span>
</span></span><span class="line"><span class="cl"><span class="na">IgnoreVirtualTextSetterCallingRules</span><span class="o">=</span><span class="s">False; Indicates that rules for virtual method calls should be ignored when trying to set the text of a text component. May in some cases help setting the text of stubborn components</span>
</span></span><span class="line"><span class="cl"><span class="na">MaxTextParserRecursion</span><span class="o">=</span><span class="s">1         ;Indicates how many levels of recursion are allowed when text is parsed so it can be translated in different parts. This can be used with splitter-regexes in advanced scenarios. The default value of one essentially means that recursion is disabled.</span>
</span></span><span class="line"><span class="cl"><span class="na">HtmlEntityPreprocessing</span><span class="o">=</span><span class="s">True     ;Will preprocess and decode html entities before they are send for translation. Some translators will fail when html entities are sent.</span>
</span></span><span class="line"><span class="cl"><span class="na">HandleRichText</span><span class="o">=</span><span class="s">True              ;Will enable automated handling of rich text (text with markup)</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableTranslationHelper</span><span class="o">=</span><span class="s">False    ;Indicates if translator-related helpful log messages should be enabled. May be useful when tranlating based on redirected resources</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[Texture]</span>
</span></span><span class="line"><span class="cl"><span class="na">TextureDirectory</span><span class="o">=</span><span class="s">Translation\{Lang}\Texture ;Directory to dump textures to, and root of directories to load images from. Can use placeholder: {GameExeName}, {Lang}</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableTextureTranslation</span><span class="o">=</span><span class="s">False   ;Indicates whether the plugin will attempt to replace in-game images with those from the TextureDirectory directory</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableTextureDumping</span><span class="o">=</span><span class="s">False       ;Indicates whether the plugin will dump texture it is capable of replacing to the TextureDirectory. Has significant performance impact</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableTextureToggling</span><span class="o">=</span><span class="s">False      ;Indicates whether or not toggling the translation with the ALT+T hotkey will also affect textures. Not guaranteed to work for all textures. Has significant performance impact</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableTextureScanOnSceneLoad</span><span class="o">=</span><span class="s">False ;Indicates whether or not the plugin should scan for textures on scene load. This enables the plugin to find and (possibly) replace more texture</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableSpriteRendererHooking</span><span class="o">=</span><span class="s">False ;Indicates whether or not the plugin should attempt to hook SpriteRenderer. This is a seperate option because SpriteRenderer can&#39;t actually be hooked properly and the implemented workaround could have a theoretical impact on performance in certain situations</span>
</span></span><span class="line"><span class="cl"><span class="na">LoadUnmodifiedTextures</span><span class="o">=</span><span class="s">False     ;Indicates whether or not unmodified textures should be loaded. Modifications are determined based on the hash in the file name. Only enable this for debugging purposes as it is likely to cause oddities</span>
</span></span><span class="line"><span class="cl"><span class="na">TextureHashGenerationStrategy</span><span class="o">=</span><span class="s">FromImageName ;Indicates how the mod identifies pictures through hashes. Can be [&#34;FromImageName&#34;, &#34;FromImageData&#34;, &#34;FromImageNameAndScene&#34;]</span>
</span></span><span class="line"><span class="cl"><span class="na">DuplicateTextureNames</span><span class="o">=</span>           <span class="s">;Indicates specific texture names that are duplicated in the game. List is separated by &#39;;&#39;.</span>
</span></span><span class="line"><span class="cl"><span class="na">DetectDuplicateTextureNames</span><span class="o">=</span><span class="s">False;Indicates if the plugin should detect duplicate texture names.</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableLegacyTextureLoading</span><span class="o">=</span><span class="s">False ;Indicates the plugin should use a different strategy to load images, that may be relevant if the game engine is old</span>
</span></span><span class="line"><span class="cl"><span class="na">CacheTexturesInMemory</span><span class="o">=</span><span class="s">True       ;Indicates that all textures loaded should be kept in memory for optimal performance. Disable to decrease memory usage</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[ResourceRedirector]</span>
</span></span><span class="line"><span class="cl"><span class="na">PreferredStoragePath</span><span class="o">=</span><span class="s">Translation\{Lang}\RedirectedResources ;Indicates the preferred storage for redirected resources in relation to the Auto Translator. Can use placeholder: {GameExeName}, {Lang}</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableTextAssetRedirector</span><span class="o">=</span><span class="s">False  ;Indicates if TextAssets should be redirected</span>
</span></span><span class="line"><span class="cl"><span class="na">LogAllLoadedResources</span><span class="o">=</span><span class="s">False      ;Indicates if the plugin should log to the console all loaded assets. Useful to determine what can be hooked</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableDumping</span><span class="o">=</span><span class="s">False              ;Indicates if translatable resources that are found should be dumped</span>
</span></span><span class="line"><span class="cl"><span class="na">CacheMetadataForAllFiles</span><span class="o">=</span><span class="s">True    ;When files are in ZIP files in the PreferredStoragePath, these files are indexed in memory to avoid performing file check IO when loading them. Enabling this option will do the same for physical files</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[Http]</span>
</span></span><span class="line"><span class="cl"><span class="na">UserAgent</span><span class="o">=</span>                       <span class="s">;Override the user agent used by APIs requiring a user agent</span>
</span></span><span class="line"><span class="cl"><span class="na">DisableCertificateValidation</span><span class="o">=</span><span class="s">False ;Indiciates whether certificate validations for the .NET API should be disabled</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[TranslationAggregator]</span>
</span></span><span class="line"><span class="cl"><span class="na">Width</span><span class="o">=</span><span class="s">400                        ;The total width of the translation aggregator window.</span>
</span></span><span class="line"><span class="cl"><span class="na">Height</span><span class="o">=</span><span class="s">100                       ;The width (per translator) of the translation aggregator window.</span>
</span></span><span class="line"><span class="cl"><span class="na">EnabledTranslators</span><span class="o">=</span>              <span class="s">;The id&#39;s of the translation endpoints that has been enabled in the translation aggregator window. List is separated by &#39;;&#39;.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[GoogleLegitimate]</span>
</span></span><span class="line"><span class="cl"><span class="na">GoogleAPIKey</span><span class="o">=</span>                    <span class="s">;OPTIONAL, needed if GoogleTranslateLegitimate is configured</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[BingLegitimate]</span>
</span></span><span class="line"><span class="cl"><span class="na">OcpApimSubscriptionKey</span><span class="o">=</span>          <span class="s">;OPTIONAL, needed if BingTranslateLegitimate is configured</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[Baidu]</span>
</span></span><span class="line"><span class="cl"><span class="na">BaiduAppId</span><span class="o">=</span>                      <span class="s">;OPTIONAL, needed if BaiduTranslate is configured</span>
</span></span><span class="line"><span class="cl"><span class="na">BaiduAppSecret</span><span class="o">=</span>                  <span class="s">;OPTIONAL, needed if BaiduTranslate is configured</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[Yandex]</span>
</span></span><span class="line"><span class="cl"><span class="na">YandexAPIKey</span><span class="o">=</span>                    <span class="s">;OPTIONAL, needed if YandexTranslate is configured</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[Watson]</span>
</span></span><span class="line"><span class="cl"><span class="na">Url</span><span class="o">=</span>                             <span class="s">;OPTIONAL, needed if WatsonTranslate is configured</span>
</span></span><span class="line"><span class="cl"><span class="na">Key</span><span class="o">=</span>                             <span class="s">;OPTIONAL, needed if WatsonTranslate is configured</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[Custom]</span>
</span></span><span class="line"><span class="cl"><span class="na">Url</span><span class="o">=</span>                             <span class="s">;Optional, needed if CustomTranslated is configured</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[LecPowerTranslator15]</span>
</span></span><span class="line"><span class="cl"><span class="na">InstallationPath</span><span class="o">=</span>                <span class="s">;Optional, needed if LecPowerTranslator15 is configured</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[Debug]</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableConsole</span><span class="o">=</span><span class="s">False              ;Enables the console. Do not enable if other plugins (managers) handles this</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableLog</span><span class="o">=</span><span class="s">False                  ;Enables extra logging for debugging purposes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[Migrations]</span>
</span></span><span class="line"><span class="cl"><span class="na">Enable</span><span class="o">=</span><span class="s">True                      ;Used to enable automatic migrations of this configuration file</span>
</span></span><span class="line"><span class="cl"><span class="na">Tag</span><span class="o">=</span><span class="s">4.5.0                        ;Tag representing the last version this plugin was executed under. Do not edit</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="behaviour-configuration-explanation">Behaviour Configuration Explanation</h3>
<h4 id="whitespace-handling">Whitespace Handling</h4>
<p>This section describes configuration parameters that has an effect on whitespace handling before and after performing a translation. <strong>None of these settings have an impact on the &lsquo;untranslated texts&rsquo; that are placed in the auto generated translations file.</strong></p>
<p>When it comes to automated translations, proper whitespace handling can really make or break the translation. The parameters that control whitespace handling are:</p>
<ul>
<li><code>IgnoreWhitespaceInDialogue</code></li>
<li><code>IgnoreWhitespaceInNGUI</code></li>
<li><code>MinDialogueChars</code></li>
<li><code>ForceSplitTextAfterCharacters</code></li>
</ul>
<p>The plugin first determines whether or not it should perform a special whitespace removal operation. It determines whether or not to perform this operation based on the parameters <code>IgnoreWhitespaceInDialogue</code>, <code>IgnoreWhitespaceInNGUI</code> and <code>MinDialogueChars</code>:</p>
<ul>
<li><code>IgnoreWhitespaceInDialogue</code>: If the text is longer than <code>MinDialogueChars</code>, whitespace is removed.</li>
<li><code>IgnoreWhitespaceInNGUI</code>: If the text comes from an NGUI component, whitespace is removed.</li>
</ul>
<p>After the text has been translated by the configured service, <code>ForceSplitTextAfterCharacters</code> is used to determine if the plugin should force the result into multiple lines after a certain number of characters.</p>
<p>The main reason that this type of handling can make or break a translation really comes down to whether or not whitespace is removed from the source text before sending it to the endpoint. Most endpoints (such as GoogleTranslate) consider text on multiple lines seperately, which can often result in terrible translation if an unnecessary newline is included.</p>
<h4 id="text-pre-processing">Text pre-processing</h4>
<p>While proper whitespace handling goes a long way in ensuring better translations, it is not always enough.</p>
<p>The <code>PreprocessorsFile</code> allows defining entries that modifies the text just before it is sent to the translator.</p>
<h4 id="ui-resizing">UI Resizing</h4>
<p>Often when performing a translation on a text component, the resulting text is larger than the original. This often means that there is not enough room in the text component for the result. This section describes ways to remedy that by changing important parameters of the text components.</p>
<p>By default, the plugin will attempt some basic auto-resizing behaviour, which are controlled by the following parameters: <code>EnableUIResizing</code>, <code>ResizeUILineSpacingScale</code>, <code>ForceUIResizing</code>, <code>OverrideFont</code> and <code>OverrideFontTextMeshPro</code>.</p>
<ul>
<li><code>EnableUIResizing</code>: Resizes the components when a translation is performed.</li>
<li><code>ForceUIResizing</code>: Resizes all components at all times, period.</li>
<li><code>ResizeUILineSpacingScale</code>: Changes the line spacing of resized components. UGUI only.</li>
<li><code>OverrideFont</code>: Changes the font of all text components regardless of <code>EnableUIResizing</code> and <code>ForceUIResizing</code>. UGUI only.</li>
<li><code>OverrideFontTextMeshPro</code>: Changes the font of all text components regardless of <code>EnableUIResizing</code> and <code>ForceUIResizing</code>. TextMeshPro only. This option is able to load a font in two different ways. If the specified string indicates a path within the game folder, then that file will be attempted to be loaded as an asset bundle (requires Unity 2018 or greater (or alternatively a custom asset bundle built specifically for the targeted game)). If not, it will be attempted to be loaded through the Resources API. Default resources that are often distributed with TextMeshPro are: <code>Fonts &amp; Materials/LiberationSans SDF</code> or <code>Fonts &amp; Materials/ARIAL SDF</code>.</li>
</ul>
<p>An additional note on changing the font of TextMeshPro: You can download some pre-built asset bundles for Unity 2018 and 2019 in the release tab, but for now, they are not particularly well tested. If you want to try them out, simply download the .zip folder and put one of the font assets into the game folder. Then configure it up by writing the name of the file in the configuration file in <code>OverrideFontTextMeshPro</code>.</p>
<p>Resizing of a UI component does not refer to changing of it&rsquo;s dimensions, but rather how the component handles overflow. The plugin changes the overflow parameters such that text is more likely to be displayed.</p>
<p>The configuratiaon <code>EnableUIResizing</code> and <code>ForceUIResizing</code> also control whether or not manual UI resize behaviour is enabled. See <a class="link" href="#ui-font-resizing" >this section</a> for more information.</p>
<h4 id="reducing-translation-requests">Reducing Translation Requests</h4>
<p>The following aims at reducing the number of requests send to the translation endpoint:</p>
<ul>
<li><code>EnableBatching</code>: Batches several translation requests into a single with supported endpoints.</li>
<li><code>UseStaticTranslations</code>: Enables usage of internal lookup dictionary of various english-to-japanese terms.</li>
<li><code>MaxCharactersPerTranslation</code>: Specifies the maximum length of a text to translate. Any texts longer than this is ignored by the plugin. Cannot be greater than 1000. <strong>Never redistribute this mod with this value greater than 400</strong></li>
</ul>
<h4 id="romaji-translation">Romaji &rsquo;translation&rsquo;</h4>
<p>One of the possible values as output <code>Language</code> is &lsquo;romaji&rsquo;. If you choose this as language, you will find that games often has problems showing the translations because the font does not understand the special characters used, for example the <a class="link" href="https://en.wikipedia.org/wiki/Macron_%28diacritic%29"  target="_blank" rel="noopener"
    >macron diacritic</a>.</p>
<p>To rememdy this, post processing can be applied to translations when &lsquo;romaji&rsquo; is chosen as <code>Language</code>. This is done through the option <code>RomajiPostProcessing</code>. This option is a &lsquo;;&rsquo;-seperated list of values:</p>
<ul>
<li><code>RemoveAllDiacritics</code>: Remove all diacritics from the translated text</li>
<li><code>ReplaceMacronWithCircumflex</code>: Replaces the macron diacritic with a circumflex.</li>
<li><code>RemoveApostrophes</code>: Some translators might decide to include apostrophes after the &rsquo;n&rsquo;-character. Applying this option removes those.</li>
<li><code>ReplaceWideCharacters</code>: Replaces wide-width japanese characters with standard ASCII characters</li>
</ul>
<p>This type of post processing is also applied to normal translations, but instead uses the option <code>TranslationPostProcessing</code>, which can use the same values.</p>
<h4 id="monomod-hooks">MonoMod Hooks</h4>
<p>MonoMod hooks are hooks are created at runtime, but not through the Harmony dependency. Harmony has two primary problems that these hooks attempt to solve:</p>
<ul>
<li>Harmony cannot hook methods with no body.</li>
<li>Harmony cannot hook methods under the <code>netstandard2.0</code> API surface, which later versions of Unity can be build under.</li>
</ul>
<p>MonoMod solves both of these problems. In order to use MonoMod hooks the libraries <code>MonoMod.RuntimeDetours.dll</code>, <code>MonoMod.Utils.dll</code> and <code>Mono.Cecil.dll</code> must be available to the plugin. These are optional dependencies.</p>
<p>These are only available in the following packages:</p>
<ul>
<li><code>XUnity.AutoTranslator-BepIn-5x-{VERSION}.zip</code> (because all dependencies are distributed with BepInEx 5.x)</li>
<li><code>XUnity.AutoTranslator-IPA-{VERSION}.zip</code> (because all dependencies are included in the package)</li>
<li><code>XUnity.AutoTranslator-ReiPatcher-{VERSION}.zip</code> (because all dependencies are included in the package)</li>
</ul>
<p>They are not distributed in the BepInEx 4.x because of the potential for conflicts in mod packages for various games.</p>
<p>The following configuration controls the MonoMod hooks:</p>
<ul>
<li><code>ForceMonoModHooks</code>: Forces the plugin to use MonoMod hooks over Harmony hooks.</li>
</ul>
<p>If MonoMod hooks are not forced they are only used if available and a given method cannot be hooked through Harmony for one of the two reasons mentioned above.</p>
<h4 id="other-options">Other Options</h4>
<ul>
<li><code>TextGetterCompatibilityMode</code>: This mode fools the game into thinking that the text displayed is not translated. This is required if the game uses text displayed to the user to determine what logic to execute. You can easily determine if this is required if you can see the functionality works fine if you toggle the translation off (hotkey: ALT+T).</li>
<li><code>IgnoreTextStartingWith</code>: Disable translation for any texts starting with values in this &lsquo;;-separated&rsquo; setting. The <a class="link" href="https://www.charbase.com/180e-unicode-mongolian-vowel-separator"  target="_blank" rel="noopener"
    >default value</a> is an invisible character that takes up no space.</li>
<li><code>CopyToClipboard</code>: Copy text to translate to the clipboard to support tools such as Translation Aggregator.</li>
<li><code>EnableSilentMode</code>: Indicates the plugin should not print out success messages in relation to translations.</li>
<li><code>BlacklistedIMGUIPlugins</code>: If an IMGUI window assembly/class/method name contains any of the strings in this list (case insensitive) that UI will not be translated. Requires MonoMod hooks. This is a list seperated by &lsquo;;&rsquo;.</li>
<li><code>OutputUntranslatableText</code>: Indicates if texts that are considered by the plugin to be untranslatable should be output to the specified OutputFile. Enabling this may also output a lot of garbage to the <code>OutputFile</code> that should be deleted before potential redistribution. <strong>Never redistribute the mod with this enabled.</strong></li>
<li><code>IgnoreVirtualTextSetterCallingRules</code>: Indicates that rules for virtual method calls should be ignored when trying to set the text of a text component. May in some cases help setting the text of stubborn components.</li>
</ul>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<blockquote>
<p><strong>Q: Why doesn&rsquo;t this plugin work in game X?</strong><br>
A: There can be a host of reasons. If the game is AOT compiled with IL2CPP it will not work (check _Data directory). If you see translations being queued (ALT+0) but never completing, a potential solution is to select a compatibility endpoint from the dropdown.</p>
</blockquote>
<blockquote>
<p><strong>Q: How do I disable auto translations?</strong><br>
A: Select the empty endpoint when you press ALT+0 or set the configuration parameter <code>Endpoint=</code> to empty.</p>
</blockquote>
<blockquote>
<p><strong>Q: How do I disable the plugin entirely?</strong><br>
A: You can do so by deleting the &ldquo;XUnity.AutoTranslator&rdquo; directory in the &ldquo;{GameDirectory}\BepInEx\plugins&rdquo; directory. Avoid deleting the &ldquo;XUnity.ResourceRedirector&rdquo; directory as other plugins may depend on it.</p>
</blockquote>
<blockquote>
<p><strong>Q: The game stops working when this plugin applies translations.</strong><br>
A: Try setting the following configuration parameter <code>TextGetterCompatibilityMode=True</code>.</p>
</blockquote>
<blockquote>
<p><strong>Q: Can this plugin translate other plugins/mods?</strong><br>
A: Likely yes, see <a class="link" href="#translating-mods" >here</a>.</p>
</blockquote>
<blockquote>
<p><strong>Q: How do I use CustomTranslate?</strong><br>
A: If you have to ask, you probably can&rsquo;t. CustomTranslate is intended for developers of a translation service. They would be able to expose an API that conforms to CustomTranslate&rsquo;s API specification without needing to implement a custom ITranslateEndpoint in this plugin as well.</p>
</blockquote>
<blockquote>
<p><strong>Q: Please provide support for translation service X.</strong><br>
A: For now, additional support for services that does not require some form of authentication is unlikely. Do note though, that it is possible to implement custom translators independently of this plugin. And it takes remarkably little code to do so.</p>
</blockquote>
<h2 id="translating-mods">Translating Mods</h2>
<p>Often other mods UI are implemented through IMGUI. As you can see above, this is disabled by default. By changing the &ldquo;EnableIMGUI&rdquo; value to &ldquo;True&rdquo;, it will start translating IMGUI as well, which likely means that other mods UI will be translated.</p>
<p>This may seem like a nice feature to have enabled by default but <strong>never redistribute the mod with this enabled</strong>. The reason here being that IMGUI has a very spammy nature. This does not mean that IMGUI in general will spam the endpoint, just that it is more likely to cause spam (and therefore cause the plugin to shutdown).</p>
<h2 id="manual-translations">Manual Translations</h2>
<p>When you use this plugin, you can always go to the file <code>Translation\{Lang}\Text\_AutoGeneratedTranslations.txt</code> (OutputFile) to edit any auto generated translations and they will show up the next time you run the game. Or you can press (ALT+R) to reload the translation immediately.</p>
<p>It is also worth noting that this plugin will read all text files (*.txt) in the <code>Translation</code> (Directory), so if you want to provide a manual translation, you can simply cut out texts from the <code>Translation\_AutoGeneratedTranslations.{lang}.txt</code> (OutputFile) and place them in new text files in order to replace them with a manual translation. These text files can also be placed in standard .zip archives.</p>
<p>In this context, the <code>Translation\{Lang}\Text\_AutoGeneratedTranslations.txt</code> (OutputFile) will always have the lowest priority when reading translations. So if the same translation is present in two places, it will not be the one from the (OutputFile) that is used.</p>
<p>In some ADV engines text &lsquo;scrolls&rsquo; into place slowly. Different techniques are used for this and in some instances if you want the translated text to be scrolling in instead of the untranslated text, you may need to set <code>GeneratePartialTranslations=True</code>. This should not be turned on unless required by the game.</p>
<h3 id="substitutions">Substitutions</h3>
<p>It is also possible to add substitutions that are applied to found texts before translations are created. This is controlled through the <code>SubstitutionFile</code>, which uses the same format as normal translation text files, although things like regexes are not supported.</p>
<p>This is useful for replacing names that are often translated incorrectly, etc.</p>
<p>When using substitutions, the found occurrences will be parameterized in the generated translations, like so:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ÁßÅ„ÅØ{{A}}=I am {{A}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Alternatively, if the configuration <code>GenerateStaticSubstitutionTranslations=True</code> is used the translations will not be parameterized.</p>
<p>When creating manual translations, use this file as sparingly as you would use regexes, as it can have an effect on performance.</p>
<p><em>NOTE: If the text to be translated includes rich text, it cannot currently be parameterized.</em></p>
<h3 id="regex-usage">Regex Usage</h3>
<p>Text translation files support regexes as well. Always remember to use regexes as sparing as possible and scope them as much as possible to avoid performance issues.</p>
<p>Regexes can be applied to translations in two different ways. The following two sections describes these two ways:</p>
<h4 id="standard-regex-translation">Standard Regex Translation</h4>
<p>Standard regex translation are simply regexes that applied directly onto a translatable text, if no direct lookup can be found.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">r:&#34;^„Ç∑„É≥„Éó„É´„É™„É≥„Ç∞ ([0-9]+)$&#34;=Simple Ring $1
</span></span></code></pre></td></tr></table>
</div>
</div><p>These are identified by the untranslated text starting with &lsquo;r:&rsquo;.</p>
<h4 id="splitter-regex">Splitter Regex</h4>
<p>Sometimes games likes to combine texts before displaying them on screen. This means that it can sometimes be hard to know what text to add to the translation file because it appears in a number of different ways.</p>
<p>This section explores a solution to this by applying a regex to split the text to be translated into individual pieces before trying to make lookups for the specified texts.</p>
<p>For example, let&rsquo;s say an accessory (Simple Ring) would be translated with the following line <code>„Ç∑„É≥„Éó„É´„É™„É≥„Ç∞=Simple Ring</code>. Now lets say this appears in multiple textboxes throughout the game like <code>01 „Ç∑„É≥„Éó„É´„É™„É≥„Ç∞</code> and <code>02 „Ç∑„É≥„Éó„É´„É™„É≥„Ç∞</code>. Providing a standard regex in a translation file to handle this is not going to work because you would need a regex for each accessory and this would not be performant at all.</p>
<p>However, if we split the translation before trying to make lookups it will allow us to only have a single simple translation in our file, like this: <code>„Ç∑„É≥„Éó„É´„É™„É≥„Ç∞=Simple Ring</code>.</p>
<p>Simply place the following regex in a translation file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sr:&#34;^([0-9]{2}) ([\S\s]+)$&#34;=$1 $2
</span></span></code></pre></td></tr></table>
</div>
</div><p>This will split up the text to be translated into two parts, translate them individually and put them back together.</p>
<p>These are identified by the untranslated text starting with &lsquo;sr:&rsquo;.</p>
<p>It is also worth noting that this methodology can be used recursively, if configured. This means that it allows the individual strings that were split for translations by a regex, to flow into another splitter regex, and so on.</p>
<p>In addition to identifying each group by index, they can also be identified by a name, which allows groups to be completely additional. Let&rsquo;s take a look at an example that combines all of these things:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sr:&#34;^\[(?&lt;stat&gt;[\w\s]+)(?&lt;num_i&gt;[\+\-]{1}[0-9]+)?\](?&lt;after&gt;[\s\S]+)?$&#34;=&#34;[${stat}${num_i}]${after}&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>In this example there are 3 named groups, two of which are optional (standard regex syntax). The replacement pattern identifies these named group by surrounding the name with <code>${}</code>.</p>
<p>If the identifier name ends in <code>_i</code> it means that the string will not be attempted to be translated, but rather transfered as is. Generally this is not really needed as the plugin is smart enough to determine if something should be translated or not.</p>
<p>So what would this regex split? It would split strings like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[DEF+14][ATK+64][DEX+34][AGI]
</span></span></code></pre></td></tr></table>
</div>
</div><p>The group(s) <code>(?&lt;stat&gt;[\w]+)(?&lt;num_i&gt;[\+\-]{1}[0-9]+)?</code> matches the text inside the <code>[]</code>. As you can see there are two groups. The first is requried and represents the text. The second is optional and represents the plus-/minus sign and number that comes after.</p>
<p>The group <code>(?&lt;after&gt;[\s\S]+)</code> matches whatever comes after. Because of this, it will attempt to translate that text like any other, and that may flow directly back into this splitter regex.</p>
<h3 id="ui-font-resizing">UI Font Resizing</h3>
<p>It is also possible to manually control the font size of text components. This is useful when the translated text uses more space than the untranslated text.</p>
<p>You can control this in files that end in <code>resizer.txt</code> placed in the translation <code>Directory</code>. This file takes a simply syntax like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">CharaCustom/CustomControl/CanvasDraw=ChangeFontSizeByPercentage(0.5)
</span></span></code></pre></td></tr></table>
</div>
</div><p>In these files, the left-hand side of the equals sign represents a (partial) path to the components that must have their fonts resized. The right-hand sized represent a &lsquo;;&rsquo;-separated list of the command to perform on those texts.</p>
<p>In the shown example it will reduce the font size of all texts below the specified path to 50%.</p>
<p>Like any other translation file, these files also support translation scoping, as decribed in <a class="link" href="#translation-scoping" >this section</a>.</p>
<p>The following types of commands exists:</p>
<ul>
<li>Commands that change the font size to a static size:
<ul>
<li><code>ChangeFontSizeByPercentage(double percentage)</code>: Where the percentage is the percentage of the original font size to reduce it to.</li>
<li><code>ChangeFontSize(int size)</code>: Where the size if the new size of the font</li>
<li><code>IgnoreFontSize()</code>: This can be used to reset font resize behavior that was set on a very &rsquo;non-specific&rsquo; path.</li>
</ul>
</li>
<li>Commands that control auto-resizing:
<ul>
<li><code>AutoResize(bool enabled)</code>: Where enabled control if auto-resize behaviour should be enabled.</li>
</ul>
</li>
<li>Commands that control the line spacing (UGUI only):
<ul>
<li><code>UGUI_ChangeLineSpacingByPercentage(float percentage)</code></li>
<li><code>UGUI_ChangeLineSpacing(float lineSpacing)</code></li>
</ul>
</li>
<li>Commands that control horizontal overflow (UGUI only):
<ul>
<li><code>UGUI_HorizontalOverflow(string mode)</code> - possible values: [wrap, overflow]</li>
</ul>
</li>
<li>Commands that control vertical overflow (UGUI only):
<ul>
<li><code>UGUI_VerticalOverflow(string mode)</code> - possible values: [truncate, overflow]</li>
</ul>
</li>
</ul>
<p>But stop you say! How would I determine the path to use? This plugin provides no way to easily determine this, but there are other plugins that will allow you to do this.</p>
<p>There&rsquo;s two ways, and you will likely need to use both of them:</p>
<ul>
<li>Using <a class="link" href="https://github.com/ManlyMarco/RuntimeUnityEditor"  target="_blank" rel="noopener"
    >Runtime Unity Editor</a> to determine these.</li>
<li>Enabling the option <code>[Behaviour] EnableTextPathLogging=True</code>, which will log out the path to all text components that text are changed on.</li>
</ul>
<h3 id="translation-scoping">Translation Scoping</h3>
<p>The following two options are available when it comes to scoping translations to only part of the game:</p>
<p>The translation files support the following directives:</p>
<ul>
<li><code>#set level 1,2,3</code> tells the plugin that translations following this line in this file may only be applied in scenes with ID 1, 2 or 3.</li>
<li><code>#unset level 1,2,3</code> tells the plugin that translations following this line in this file should not be applied in scenes with ID 1, 2 or 3. If no levels are set, all specified translations are global.</li>
<li><code>#set exe game1,game2</code> tells the plugin that translations following this line in this file may only be applied when the game is run through an executable with the name game1 or game2.</li>
<li><code>#unset exe game1,game2</code> tells the plugin that translations following this line in this file should not be applied when the game is run through an executable with the name game1 or game2. If no exes are set, all specified translations are global.</li>
</ul>
<p>For this to work, the following configuration option must be changed, as it defaults to <code>False</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[Behaviour]
</span></span><span class="line"><span class="cl">EnableTranslationScoping=True
</span></span></code></pre></td></tr></table>
</div>
</div><p>Also, this behaviour is not available in the <code>OutputFile</code>.</p>
<p>You can always see which levels are loaded by using the hotkey CTRL+ALT+NP7.</p>
<p>Another way of scoping translations are through file names. It is possible to tell the plugin where to look for translation files. It is possible to parameterize these paths with the variable {GameExeName}.</p>
<p>Example configuration that seperates translations for each executable:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[Files]
</span></span><span class="line"><span class="cl">Directory=Translation\{GameExeName}\{Lang}\Text
</span></span><span class="line"><span class="cl">Directory=Translation\{GameExeName}\{Lang}\Text\_AutoGeneratedTranslations.txt
</span></span><span class="line"><span class="cl">Directory=Translation\{GameExeName}\{Lang}\Text\_Substitutions.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p>So when should use scope your translations? Well that depends on the type of scope:</p>
<ul>
<li><code>level</code> scopes should really only be used to avoid translation collisions</li>
<li><code>exe</code> scopes can be used both to avoid translation collisions and to enhance performance</li>
</ul>
<h3 id="text-lookup-and-whitespace-handling">Text Lookup and Whitespace Handling</h3>
<p>This section is provided to give the translator an understanding of how this plugin looks up texts and provides translations.</p>
<p>In the simplest form, the way the plugin works is as a dictionary of untranslated text strings. When plugin sees a text that it considers untranslated, it will attempt to look up the text string in the dictionary and if it finds a result, it will display the found translation instead.</p>
<p>The world, however, is not always that simple. Depending on the engine/text framework used by a game, an untranslated text string may be slightly different when used in different contexts. For example for a VN it may not be the exact same text string that appears in the &ldquo;ADV history&rdquo;-view as it was when it was being initially displayed to the user.</p>
<p><strong>Example:</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">„Äå„Åì„ÅÜË¶ã„Åà„Å¶ÊÄí„Å£„Å¶„ÅÑ„Çã„Çì„Åß„Åô„ÇàÔºü‚Ä¶‚Ä¶Â§±Á§º„Åó„Åæ„Åô„Å≠„Äç
</span></span><span class="line"><span class="cl">„Äå„Åì„ÅÜË¶ã„Åà„Å¶ÊÄí„Å£„Å¶„ÅÑ„Çã„Çì„Åß„Åô„ÇàÔºü\n ‚Ä¶‚Ä¶Â§±Á§º„Åó„Åæ„Åô„Å≠„Äç
</span></span></code></pre></td></tr></table>
</div>
</div><p>These text strings are not the same and it would be annoying having to translate the same text multiple times if the final translation is supposed to be the same.</p>
<p>In fact, only one of these translations are needed. Here&rsquo;s why: (still very much simplified):</p>
<ol>
<li>When the plugin sees an untranslated text, it will actually make four lookups, not one. These are, in order:
<ul>
<li>Based on the untouched original text</li>
<li>Based on the original text but without leading/trailing whitespace. If found the leading/trailing whitespace is added to the resulting translation</li>
<li>Based on the original text but without internal non-repeating whitespace surrounding a newline</li>
<li>Based on the original text but without leading/trailing whitespace and internal non-repeating whitespace surrounding a newline. If found the leading/trailing whitespace is added to the resulting translation</li>
</ul>
</li>
</ol>
<p>This means that for the following string <code>\n „Äå„Åì„ÅÜË¶ã„Åà„Å¶ÊÄí„Å£„Å¶„ÅÑ„Çã„Çì„Åß„Åô„ÇàÔºü\n ‚Ä¶‚Ä¶Â§±Á§º„Åó„Åæ„Åô„Å≠„Äç</code> the plugin will make the following lookups:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">\n „Äå„Åì„ÅÜË¶ã„Åà„Å¶ÊÄí„Å£„Å¶„ÅÑ„Çã„Çì„Åß„Åô„ÇàÔºü\n ‚Ä¶‚Ä¶Â§±Á§º„Åó„Åæ„Åô„Å≠„Äç
</span></span><span class="line"><span class="cl">„Äå„Åì„ÅÜË¶ã„Åà„Å¶ÊÄí„Å£„Å¶„ÅÑ„Çã„Çì„Åß„Åô„ÇàÔºü\n ‚Ä¶‚Ä¶Â§±Á§º„Åó„Åæ„Åô„Å≠„Äç
</span></span><span class="line"><span class="cl">\n „Äå„Åì„ÅÜË¶ã„Åà„Å¶ÊÄí„Å£„Å¶„ÅÑ„Çã„Çì„Åß„Åô„ÇàÔºü‚Ä¶‚Ä¶Â§±Á§º„Åó„Åæ„Åô„Å≠„Äç
</span></span><span class="line"><span class="cl">„Äå„Åì„ÅÜË¶ã„Åà„Å¶ÊÄí„Å£„Å¶„ÅÑ„Çã„Çì„Åß„Åô„ÇàÔºü‚Ä¶‚Ä¶Â§±Á§º„Åó„Åæ„Åô„Å≠„Äç
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>When the plugin loads the (manual/automatic) translation it will not make one dictionary entry, but three. These are:
<ul>
<li>Based on the untouched original text and original translation</li>
<li>Based on the original text (without leading/trailing whitespace) and original translation (without leading/trailing whitespace)</li>
<li>Based on the original text (without leading/trailing whitespace and internal non-repeating whitespace surrounding a newline) and original translation (without leading/trailing whitespace and internal non-repeating whitespace surrounding a newline)</li>
</ul>
</li>
</ol>
<p>This means that for the following string <code>\n „Äå„Åì„ÅÜË¶ã„Åà„Å¶ÊÄí„Å£„Å¶„ÅÑ„Çã„Çì„Åß„Åô„ÇàÔºü\n ‚Ä¶‚Ä¶Â§±Á§º„Åó„Åæ„Åô„Å≠„Äç</code> the plugin will make the following entries:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">\n „Äå„Åì„ÅÜË¶ã„Åà„Å¶ÊÄí„Å£„Å¶„ÅÑ„Çã„Çì„Åß„Åô„ÇàÔºü\n ‚Ä¶‚Ä¶Â§±Á§º„Åó„Åæ„Åô„Å≠„Äç
</span></span><span class="line"><span class="cl">„Äå„Åì„ÅÜË¶ã„Åà„Å¶ÊÄí„Å£„Å¶„ÅÑ„Çã„Çì„Åß„Åô„ÇàÔºü\n ‚Ä¶‚Ä¶Â§±Á§º„Åó„Åæ„Åô„Å≠„Äç
</span></span><span class="line"><span class="cl">„Äå„Åì„ÅÜË¶ã„Åà„Å¶ÊÄí„Å£„Å¶„ÅÑ„Çã„Çì„Åß„Åô„ÇàÔºü‚Ä¶‚Ä¶Â§±Á§º„Åó„Åæ„Åô„Å≠„Äç
</span></span></code></pre></td></tr></table>
</div>
</div><p>This means you can get away with providing a single translation for both of these cases. Which you think is better is up to you.</p>
<p>Another thing to note is that the plugin will always output the original text without modifications in the translation file. But if it sees another text afterwards that is &ldquo;compatible&rdquo; with that text-string (due to the above mentioned text modifications) it will not output this new text by default.</p>
<p>This is controlled by the configuration option <code>CacheWhitespaceDifferences=False</code>. You can change this to true, and it will output a new entry for each unique text, even if the only differences are whitespace. Obviously, translations-pairs actually appearing in the translation file will always that precendent over translations-pairs that are generated based on an exinsting translation-pair.</p>
<p><em>NOTE: Whitespace differences in relation to level-scoped translations will never be output regardless of this setting.</em></p>
<h3 id="resource-redirection">Resource Redirection</h3>
<p>Sometimes it&rsquo;s easier to provide a translation to a game by directly overriding the game resource files. However, directly overriding the game resource files is also problematic because that means the modification will likely only work for one version of the game.</p>
<p>To overcome this problem, and allow for modification of resource files, this plugin also has a resource redirector module that allows redirecting any kind of resource loaded by the game.</p>
<p>Before we get into the details of this module, it is worth mentioning that it is:</p>
<ul>
<li>It is not a plugin. Rather it is just a library that is not beholden to any plugin manager (it does come with a plugin-compatible BepInEx DLL but this is only to manage configuration).</li>
<li>It is game independent.</li>
<li>And while it may be redistributed with the Auto Translator, it is completely independent from it and it can be used without having the Auto Translator installed.</li>
</ul>
<p>The DLLs required for the Resource Redirector to work are <code>XUnity.Common.dll</code> and <code>XUnity.ResourceRedirector.dll</code>. By themselves, these libraries do nothing.</p>
<p>By default the Auto Translator plugin comes with one resource redirector for <code>TextAsset</code>, which basically outputs the raw text assets to the file system allowing them to be individually overridden.</p>
<p>More redirectors can be implemented for specific games, though this does require programming knowledge, see <a class="link" href="#implementing-a-resource-redirector" >this section</a> for more information.</p>
<p>The Auto Translator has the following Resource Redirector-specific configuration:</p>
<ul>
<li><code>PreferredStoragePath</code>: Indicates where the Auto Translator should store redirected resources.</li>
<li><code>EnableTextAssetRedirector</code>: Indicates if the TextAsset redirector is enabled.</li>
<li><code>LogAllLoadedResources</code>: Indicates if Resource Redirector should log all resources to the console (can also be controlled through Resource Redirector API surface).</li>
<li><code>EnableDumping</code>: Indicates if resources redirected to the Auto Translator should be dumped for overwriting if possible.</li>
<li><code>CacheMetadataForAllFiles</code>: When files are in ZIP files in the PreferredStoragePath, these files are indexed in memory to avoid performing file check IO when loading them. Enabling this option will do the same for physical files</li>
</ul>
<p>ZIP files that are placed in the <code>PreferredStoragePath</code> will be indexed during startup, allowing redirected resources to be compressed and zipped. When files are placed in a zip file, the zip file is simply treated as not existing during file lookup.</p>
<h2 id="regarding-redistribution">Regarding Redistribution</h2>
<p>Redistributing this plugin for various games is absolutely encouraged. However, if you do so, please keep the following in mind:</p>
<ul>
<li><strong>Distribute the _AutoGeneratedTranslations.txt file along with the redistribution with as many translations as possible to ensure the online translator is hit as little as possible.</strong></li>
<li><strong>Test your redistribution with logging/console enabled to ensure the game does not exhibit undesirable behaviour such as spamming the endpoints.</strong></li>
<li>Ensure you keep the plugin up-to-date, as much as reasonably possible.</li>
<li>If you use image loading feature, make sure you read <a class="link" href="#texture-translation" >this section</a>.</li>
</ul>
<h2 id="texture-translation">Texture Translation</h2>
<p>From version 2.16.0+ this mod provides basic capabilities to replace images. It is a feature that is disabled by default. There is no automatic translation of these images though.</p>
<p>This feature is primarily meant for games with little to no mod support to enable full translations without needing to modify resource files.</p>
<p>It is controlled by the following configuration:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="k">[Texture]</span>
</span></span><span class="line"><span class="cl"><span class="na">TextureDirectory</span><span class="o">=</span><span class="s">Translation\Texture</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableTextureTranslation</span><span class="o">=</span><span class="s">False</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableTextureDumping</span><span class="o">=</span><span class="s">False</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableTextureToggling</span><span class="o">=</span><span class="s">False</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableTextureScanOnSceneLoad</span><span class="o">=</span><span class="s">False</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableSpriteRendererHooking</span><span class="o">=</span><span class="s">False</span>
</span></span><span class="line"><span class="cl"><span class="na">LoadUnmodifiedTextures</span><span class="o">=</span><span class="s">False</span>
</span></span><span class="line"><span class="cl"><span class="na">TextureHashGenerationStrategy</span><span class="o">=</span><span class="s">FromImageName</span>
</span></span><span class="line"><span class="cl"><span class="na">DuplicateTextureNames</span><span class="o">=</span>
</span></span><span class="line"><span class="cl"><span class="na">DetectDuplicateTextureNames</span><span class="o">=</span><span class="s">False</span>
</span></span><span class="line"><span class="cl"><span class="na">EnableLegacyTextureLoading</span><span class="o">=</span><span class="s">False</span>
</span></span><span class="line"><span class="cl"><span class="na">CacheTexturesInMemory</span><span class="o">=</span><span class="s">True</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>TextureDirectory</code> specifies the directory where textures are dumped to and loaded from. Loading will happen from all subdirectories of the specified directory as well, so you can move dumped images to whatever folder structure you desire.</p>
<p><code>EnableTextureTranslation</code> enables texture translation. This basically means that textures will be loaded from the <code>TextureDirectory</code> and it&rsquo;s subsdirectories. These images will replace the in-game images used by the game.</p>
<p><code>EnableTextureDumping</code> enables texture dumping. This means that the mod will dump any images it has not already dumped to the <code>TextureDirectory</code>. When dumping textures, it may also be worth enabling <code>EnableTextureScanOnSceneLoad</code> to more quickly find all textures that require translating. <strong>Never redistribute the mod with this enabled.</strong></p>
<p><code>EnableTextureScanOnSceneLoad</code> allows the plugin to scan for texture objects on the sceneLoad event. This enables the plugin to find more texture at a tiny performance cost during scene load (which is often during loading screens, etc.). However, because of the way Unity works not all of these are guaranteed to be replacable. If you find an image that is dumped but cannot be translated, please report it. However, please recognize this mod is primarily intended for replacing UI textures, not textures for 3D meshes.</p>
<p><code>EnableSpriteRendererHooking</code> allows the plugin to attempt to hook SpriteRenderer. This is a seperate option because SpriteRenderer can&rsquo;t actually be hooked properly and the implemented workaround could have a theoretical impact on performance in certain situations.</p>
<p><code>LoadUnmodifiedTextures</code> enables whether or not the plugin should load textures that has not been modified. This is only useful for debugging, and likely to cause various visual glitches, especially if <code>EnableTextureScanOnSceneLoad</code> is also enabled. <strong>Never redistribute the mod with this enabled.</strong></p>
<p><code>EnableTextureToggling</code> enables whether the ALT+T hotkey will also toggle textures. This is by no means guaranteed to work, especially if <code>EnableTextureScanOnSceneLoad</code> is also enabled. <strong>Never redistribute the mod with this enabled.</strong></p>
<p><code>DuplicateTextureNames</code> specifies different textures in the game that are used under the same resource name. The plugin will fallback to the &lsquo;FromImageData&rsquo; for image identification for these images.</p>
<p><code>DetectDuplicateTextureNames</code> specifies that the plugin should identify which image names are duplicated and update the configuration with these names automatically. <strong>Never redistribute the mod with this enabled.</strong></p>
<p><code>EnableLegacyTextureLoading</code> specifies that the plugin should use attempt to load images differently, which may be relevant if the unity engine is old (verified with versions less than 5.3). This should not be used unless the images that are loaded are not the ones that you expected.</p>
<p><code>CacheTexturesInMemory</code> specifies that all translation textures should be kept in memory to optimize performance. Can be disabled to reduce memory usage.</p>
<p><code>TextureHashGenerationStrategy</code> specifies how images are identified. When images are stored, the game will need some way of associating them with the image that it has to replace.
This is done through a hash-value that is stored in square brackets in each image file name, like this: <code>file_name [0223B639A2-6E698E9272].png</code>. This configuration specifies how these hash-values are generated:</p>
<ul>
<li><code>FromImageName</code> means that the hash is generated from the internal resource name that the game uses for the image, which may not exist for all images or even be unique. However, it is generally fairly reliable. If an image has no resource name, it will not be dumped.</li>
<li><code>FromImageData</code> means that the hash is generated from the data stored in the image, which is guaranteed to exist for all images. However, generating the hash comes at a performance cost, that will also be incurred by the end-users.</li>
<li><code>FromImageNameAndScene</code> means that it should use the name and scene to generate a hash. The name is still required for this to work. When using this option, there is a chance the same texture could be dumped with different hashes, which is undesirable, but it could be required for some games, if the name itself is not unique and the <code>FromImageData</code> option causes performance issues. If this is used, it is recommended to enable <code>EnableTextureScanOnSceneLoad</code> as well.</li>
</ul>
<p>There&rsquo;s an important catch you need to be aware when dealing with these options and that is if ANY of these options exists: <code>EnableTextureDumping=True</code>, <code>EnableTextureToggling=True</code>, <code>TextureHashGenerationStrategy=FromImageData</code>, then the game will need to read the raw data from all images it finds in game in order to replace the image and this is an expensive operation.</p>
<p>It is therefore recommended to use <code>TextureHashGenerationStrategy=FromImageName</code>. Most likely, images without a resource name won&rsquo;t be interesting to translate anyway.</p>
<p>If you redistribute this mod with translated images, it is recommended you delete all images you either have no intention of translating or are not translated at all.</p>
<p>You can also change the file name to whatever you desire, as long as you keep the hash appended to the end of the file name.</p>
<p>If you take anything away from this section, it should be these two points:</p>
<ul>
<li><strong>Never redistribute the mod with <code>EnableTextureDumping=True</code>, <code>EnableTextureToggling=True</code>, <code>LoadUnmodifiedTextures=True</code> or <code>DetectDuplicateTextureNames=true</code></strong></li>
<li><strong>Only redistribute the mod with <code>TextureHashGenerationStrategy=FromImageData</code> enabled if absolutely required by the game.</strong></li>
</ul>
<h3 id="technical-details-about-hash-generation-in-file-names">Technical details about Hash Generation in file names</h3>
<p>There are actually two hashes in the generated file name, separated by a dash (-):</p>
<ul>
<li>The first hash is a SHA1 (only first 5 bytes) based on the <code>TextureHashGenerationStrategy</code> used. If <code>FromImageName</code> is specified, then it is based on the UTF8 (without BOM) representation.</li>
<li>The second hash is a SHA1 (only first 5 bytes) based on the data in the image. This is used to determine whether or not the image has been modified, so images that has not been edited are not loaded. Unless <code>LoadUnmodifiedTextures</code> is specified.</li>
</ul>
<p>If <code>TextureHashGenerationStrategy=FromImageData</code> is specified, only a single hash will appear in each file name, as that single hash can be used both to identify the image and to determine whether or not it has been edited.</p>
<h2 id="integrating-with-auto-translator">Integrating with Auto Translator</h2>
<p><em>NOTE: Everything below this point requires programming knowledge!</em></p>
<h3 id="implementing-a-dedicated-translation-component">Implementing a dedicated translation component</h3>
<p>As a mod author implementing a translation plugin, you are able to, if you cannot find a translation to a string, simply delegate it to this mod, and you can do it without taking any references to this plugin.</p>
<p>Here&rsquo;s how it works and what is required:</p>
<ul>
<li>You must implement a Component (MonoBehaviour for instance) that this plugin is able to locate by simply traversing all objects during startup.</li>
<li>On this component you must add an event for the text hooks you want to override from XUnity AutoTranslator. This is done on a per text framework basis. The signature of these events must be: Func&lt;object, string, string&gt;. The arguments are, in order:
<ol>
<li>The component that represents the text in the UI. (The one that probably has a property called &rsquo;text&rsquo;).</li>
<li>The untranslated text</li>
<li>This is the return value and will be the translated text IF an immediate translation took place. Otherwise it will simply be null.</li>
</ol>
</li>
<li>The signature for each framework looks like:
<ol>
<li>UGUI: public static event Func&lt;object, string, string&gt; OnUnableToTranslateUGUI</li>
<li>TextMeshPro: public static event Func&lt;object, string, string&gt; OnUnableToTranslateTextMeshPro</li>
<li>NGUI: public static event Func&lt;object, string, string&gt; OnUnableToTranslateNGUI</li>
<li>IMGUI: public static event Func&lt;object, string, string&gt; OnUnableToTranslateIMGUI</li>
<li>TextMesh: public static event Func&lt;object, string, string&gt; OnUnableToTranslateTextMesh</li>
</ol>
</li>
<li>Also, the events can be either instance based or static.</li>
</ul>
<p>Be aware that if you do this, that the hooking functionality of the Auto Translator itself will be disabled. So you are entirely responsible for implementing the required hooks for the overriden text framework.</p>
<h3 id="implementing-a-plugin-that-can-query-translations">Implementing a plugin that can query translations</h3>
<p>As a mod author, you may want to query translations from the plugin. This easily done, take a look at the example below.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">MyPlugin</span> <span class="p">:</span> <span class="n">XPluginBase</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="k">void</span> <span class="n">Start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kt">var</span> <span class="n">untranslatedText</span> <span class="p">=</span> <span class="s">&#34;„ÅäÂâç„ÅØ„ÇÇ„ÅÜÊ≠ª„Çì„Åß„ÅÑ„ÇãÔºÅ&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="c1">// EXAMPLE 1) Query cache, and if it cannot be found in cache query the user-selected translation endpoint</span>
</span></span><span class="line"><span class="cl">      <span class="n">AutoTranslator</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">TranslateAsync</span><span class="p">(</span> <span class="n">untranslatedText</span><span class="p">,</span> <span class="n">result</span> <span class="p">=&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="k">if</span><span class="p">(</span> <span class="n">result</span><span class="p">.</span><span class="n">Succeeded</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">translatedText</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">TranslatedText</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="k">else</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">errorMessage</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">ErrorMessage</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="c1">// EXAMPLE 2) Query cache only</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span><span class="p">(</span> <span class="n">AutoTranslator</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">TryTranslate</span><span class="p">(</span> <span class="n">untranslatedText</span><span class="p">,</span> <span class="k">out</span> <span class="kt">string</span> <span class="n">translation</span> <span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="c1">// success</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="c1">// failure</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This requires version 3.7.0 or later!</p>
<h3 id="implementing-a-component-that-the-auto-translator-should-not-interfere-with">Implementing a component that the Auto Translator should not interfere with</h3>
<p>As a mod author, you might not want the Auto Translator to interfere with your mods UI. If this is the case there&rsquo;s two ways to tell Auto Translator not to perform any translation:</p>
<ul>
<li>If your UI is based on GameObjects, you can simply name your GameObjects containing the text element (for example Text class) to something that contains the string &ldquo;XUAIGNORE&rdquo;. The Auto Translator will check for this and ignore components that contains the string.</li>
<li>If your UI is based on IMGUI, the above approach is not possible, because there are no GameObject. In that case you can do the following instead:</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">MyPlugin</span> <span class="p">:</span> <span class="n">XPluginBase</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="k">private</span> <span class="n">GameObject</span> <span class="n">_xua</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="k">private</span> <span class="kt">bool</span> <span class="n">_lookedForXua</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="k">void</span> <span class="n">OnGUI</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// make sure we only do this lookup once, as it otherwise may be detrimental to performance!</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// also: do not attempt to do this in the Awake method or similar of your plugin, as your plugin may be instantiated before the auto translator!</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span><span class="p">(!</span><span class="n">_lookedForXua</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="n">_lookedForXua</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">         <span class="n">_xua</span> <span class="p">=</span> <span class="n">GameObject</span><span class="p">.</span><span class="n">Find</span><span class="p">(</span> <span class="s">&#34;___XUnityAutoTranslator&#34;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="c1">// try-finally block is important to make sure you re-enable the plugin</span>
</span></span><span class="line"><span class="cl">      <span class="k">try</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="n">_xua</span><span class="p">?.</span><span class="n">SendMessage</span><span class="p">(</span><span class="s">&#34;DisableAutoTranslator&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="c1">// do your GUI things here</span>
</span></span><span class="line"><span class="cl">         <span class="n">GUILayout</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span> <span class="s">&#34;„Åì„Çì„Å´„Å°„ÅØÔºÅ&#34;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">finally</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="n">_xua</span><span class="p">?.</span><span class="n">SendMessage</span><span class="p">(</span><span class="s">&#34;EnableAutoTranslator&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This requires version 2.15.0 or later!</p>
<h2 id="implementing-a-translator">Implementing a Translator</h2>
<p>Since version 3.0.0, you can now also implement your own translators.</p>
<p>In order to do so, all you have to do is implement the following interface, build the assembly and place the generated DLL in the <code>Translators</code> folder.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// The interface that must be implemented by a translator.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">interface</span> <span class="nc">ITranslateEndpoint</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="cs">/// Gets the id of the ITranslateEndpoint that is used as a configuration parameter.</span>
</span></span><span class="line"><span class="cl">   <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="kt">string</span> <span class="n">Id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="cs">/// Gets a friendly name that can be displayed to the user representing the plugin.</span>
</span></span><span class="line"><span class="cl">   <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="kt">string</span> <span class="n">FriendlyName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="cs">/// Gets the maximum concurrency for the endpoint. This specifies how many times &#34;Translate&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="cs">/// can be called before it returns.</span>
</span></span><span class="line"><span class="cl">   <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="kt">int</span> <span class="n">MaxConcurrency</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="cs">/// Gets the maximum number of translations that can be served per translation request.</span>
</span></span><span class="line"><span class="cl">   <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="kt">int</span> <span class="n">MaxTranslationsPerRequest</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="cs">/// Called during initialization. Use this to initialize plugin or throw exception if impossible.</span>
</span></span><span class="line"><span class="cl">   <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="k">void</span> <span class="n">Initialize</span><span class="p">(</span> <span class="n">IInitializationContext</span> <span class="n">context</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="cs">/// Attempt to translated the provided untranslated text. Will be used in a &#34;coroutine&#34;,</span>
</span></span><span class="line"><span class="cl">   <span class="cs">/// so it can be implemented in an asynchronous fashion.</span>
</span></span><span class="line"><span class="cl">   <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="n">IEnumerator</span> <span class="n">Translate</span><span class="p">(</span> <span class="n">ITranslationContext</span> <span class="n">context</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Often an implementation of this interface will access an external web service. If this is the case, you do not need to implement the entire interface yourself. Instead you can rely on a base class in the <code>XUnity.AutoTranslator.Plugin.Core</code> assembly. But more on this later.</p>
<h3 id="important-notes-on-implementing-a-translator-based-on-an-online-service">Important Notes on Implementing a Translator based on an Online Service</h3>
<p>Whenever you implement a translator based on an online service, it is important to not use it in an abusive way. For example by:</p>
<ul>
<li>Establishing a large number of connections to it</li>
<li>Performing web scraping instead of using an available API</li>
<li>Making concurrent requests towards it</li>
<li><em>This is especially important if the service is not authenticated</em></li>
</ul>
<p>With that in mind, consider the following:</p>
<ul>
<li>The <code>WWW</code> class in Unity establishes a new TCP connection on each request you make, making it extremely poor at this kind of job. Especially if SSL (https) is involved because it has to do the entire handshake procedure each time. Yuck.</li>
<li>The <code>UnityWebRequest</code> class in Unity does not exist in most games, because the authors use an old engine, so it is not a good choice either.</li>
<li>The <code>WebClient</code> class from .NET is capable of using persistent connections (it does so by default), but has its own problems with SSL. The version of Mono used in most Unity games rejects all certificates by default making all HTTPS connections fail. This, however, can be remedied during the initialization phase of the translator (see examples below). Another shortcoming of this API is the fact that the runtime will never release the TCP connections it has used until the process ends. The API also integrates terribly with Unity because callbacks return on a background thread.</li>
<li>The <code>WebRequest</code> class from .NET is essentially the same as WebClient.</li>
<li>The <code>HttpClient</code> class from .NET is also unlikely to exist in most Unity games.</li>
</ul>
<p>None of these are therefore an ideal solution.</p>
<p>To remedy this, the plugin implements a class <code>XUnityWebClient</code>, which is based on Mono&rsquo;s version of WebClient. However, it adds the following features:</p>
<ul>
<li>Enables integration with Unity by returning result classes that can be &lsquo;yielded&rsquo;.</li>
<li>Properly closes connections that has not been used for 50 seconds.</li>
</ul>
<p>I recommend using this class, or in case that cannot be used, falling back to the .NET &lsquo;WebClient&rsquo;.</p>
<h3 id="how-to">How-To</h3>
<p>Follow these steps:</p>
<ol>
<li>Download XUnity.AutoTranslator-Developer-{VERSION}.zip from <a class="link" href="../../releases" >releases</a></li>
<li>Start a new project (.NET 3.5) in Visual Studio 2017 or later. I recommend using the same name for your assembly/project as the &ldquo;Id&rdquo; you are going to use in your interface implementation. This makes it easier for users to know how to configure your translator
<ul>
<li>I recommend using the &ldquo;Class Library (.NET Standard)&rdquo; and simply editing the generated .csproj file to use &rsquo;net35&rsquo; instead of &rsquo;netstandard2.0&rsquo;. This generates much cleaner .csproj files.</li>
</ul>
</li>
<li>Add a reference to the XUnity.AutoTranslator.Plugin.Core.dll that you downloaded in step 1</li>
<li>You do not need to directly reference the UnityEngine.dll assembly. This is good, because you do not need to worry about which version of Unity is used.
<ul>
<li>If you do need a reference to this assembly (because you need functionality from it) consider using an old version of it (if <code>UnityEngine.CoreModule.dll</code> exists in the Managed folder, it is not an old version!)</li>
</ul>
</li>
<li>Create a new class that either:
<ul>
<li>Implements the <code>ITranslateEndpoint</code> interface</li>
<li>Inherits from the <code>HttpEndpoint</code> class</li>
<li>Inherits from the <code>WwwEndpoint</code> class</li>
<li>Inherits from the <code>ExtProtocolEndpoint</code> class</li>
</ul>
</li>
</ol>
<p>Here&rsquo;s an example that simply reverses the text and also reads some configuration from the configuration file the plugin uses:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">ReverseTranslatorEndpoint</span> <span class="p">:</span> <span class="n">ITranslateEndpoint</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="k">private</span> <span class="kt">bool</span> <span class="n">_myConfig</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="kt">string</span> <span class="n">Id</span> <span class="p">=&gt;</span> <span class="s">&#34;ReverseTranslator&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="kt">string</span> <span class="n">FriendlyName</span> <span class="p">=&gt;</span> <span class="s">&#34;Reverser&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="kt">int</span> <span class="n">MaxConcurrency</span> <span class="p">=&gt;</span> <span class="m">50</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="kt">int</span> <span class="n">MaxTranslationsPerRequest</span> <span class="p">=&gt;</span> <span class="m">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="k">void</span> <span class="n">Initialize</span><span class="p">(</span> <span class="n">IInitializationContext</span> <span class="n">context</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">_myConfig</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">GetOrCreateSetting</span><span class="p">(</span> <span class="s">&#34;Reverser&#34;</span><span class="p">,</span> <span class="s">&#34;MyConfig&#34;</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="n">IEnumerator</span> <span class="n">Translate</span><span class="p">(</span> <span class="n">ITranslationContext</span> <span class="n">context</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kt">var</span> <span class="n">reversedText</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">string</span><span class="p">(</span> <span class="n">context</span><span class="p">.</span><span class="n">UntranslatedText</span><span class="p">.</span><span class="n">Reverse</span><span class="p">().</span><span class="n">ToArray</span><span class="p">()</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">context</span><span class="p">.</span><span class="n">Complete</span><span class="p">(</span> <span class="n">reversedText</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Arguably, this is not a particularly interesting example, but it illustrates the basic principles of what must be done in order to implement a Translator.</p>
<p>Let&rsquo;s take a look at a more advanced example that accesses the web:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">internal</span> <span class="k">class</span> <span class="nc">YandexTranslateEndpoint</span> <span class="p">:</span> <span class="n">HttpEndpoint</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">HashSet</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">SupportedLanguages</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="p">{</span> <span class="s">&#34;az&#34;</span><span class="p">,</span> <span class="s">&#34;sq&#34;</span><span class="p">,</span> <span class="s">&#34;am&#34;</span><span class="p">,</span> <span class="s">&#34;en&#34;</span><span class="p">,</span> <span class="s">&#34;ar&#34;</span><span class="p">,</span> <span class="s">&#34;hy&#34;</span><span class="p">,</span> <span class="s">&#34;af&#34;</span><span class="p">,</span> <span class="s">&#34;eu&#34;</span><span class="p">,</span> <span class="s">&#34;ba&#34;</span><span class="p">,</span> <span class="s">&#34;be&#34;</span><span class="p">,</span> <span class="s">&#34;bn&#34;</span><span class="p">,</span> <span class="s">&#34;my&#34;</span><span class="p">,</span> <span class="s">&#34;bg&#34;</span><span class="p">,</span> <span class="s">&#34;bs&#34;</span><span class="p">,</span> <span class="s">&#34;cy&#34;</span><span class="p">,</span> <span class="s">&#34;hu&#34;</span><span class="p">,</span> <span class="s">&#34;vi&#34;</span><span class="p">,</span> <span class="s">&#34;ht&#34;</span><span class="p">,</span> <span class="s">&#34;gl&#34;</span><span class="p">,</span> <span class="s">&#34;nl&#34;</span><span class="p">,</span> <span class="s">&#34;mrj&#34;</span><span class="p">,</span> <span class="s">&#34;el&#34;</span><span class="p">,</span> <span class="s">&#34;ka&#34;</span><span class="p">,</span> <span class="s">&#34;gu&#34;</span><span class="p">,</span> <span class="s">&#34;da&#34;</span><span class="p">,</span> <span class="s">&#34;he&#34;</span><span class="p">,</span> <span class="s">&#34;yi&#34;</span><span class="p">,</span> <span class="s">&#34;id&#34;</span><span class="p">,</span> <span class="s">&#34;ga&#34;</span><span class="p">,</span> <span class="s">&#34;it&#34;</span><span class="p">,</span> <span class="s">&#34;is&#34;</span><span class="p">,</span> <span class="s">&#34;es&#34;</span><span class="p">,</span> <span class="s">&#34;kk&#34;</span><span class="p">,</span> <span class="s">&#34;kn&#34;</span><span class="p">,</span> <span class="s">&#34;ca&#34;</span><span class="p">,</span> <span class="s">&#34;ky&#34;</span><span class="p">,</span> <span class="s">&#34;zh&#34;</span><span class="p">,</span> <span class="s">&#34;ko&#34;</span><span class="p">,</span> <span class="s">&#34;xh&#34;</span><span class="p">,</span> <span class="s">&#34;km&#34;</span><span class="p">,</span> <span class="s">&#34;lo&#34;</span><span class="p">,</span> <span class="s">&#34;la&#34;</span><span class="p">,</span> <span class="s">&#34;lv&#34;</span><span class="p">,</span> <span class="s">&#34;lt&#34;</span><span class="p">,</span> <span class="s">&#34;lb&#34;</span><span class="p">,</span> <span class="s">&#34;mg&#34;</span><span class="p">,</span> <span class="s">&#34;ms&#34;</span><span class="p">,</span> <span class="s">&#34;ml&#34;</span><span class="p">,</span> <span class="s">&#34;mt&#34;</span><span class="p">,</span> <span class="s">&#34;mk&#34;</span><span class="p">,</span> <span class="s">&#34;mi&#34;</span><span class="p">,</span> <span class="s">&#34;mr&#34;</span><span class="p">,</span> <span class="s">&#34;mhr&#34;</span><span class="p">,</span> <span class="s">&#34;mn&#34;</span><span class="p">,</span> <span class="s">&#34;de&#34;</span><span class="p">,</span> <span class="s">&#34;ne&#34;</span><span class="p">,</span> <span class="s">&#34;no&#34;</span><span class="p">,</span> <span class="s">&#34;pa&#34;</span><span class="p">,</span> <span class="s">&#34;pap&#34;</span><span class="p">,</span> <span class="s">&#34;fa&#34;</span><span class="p">,</span> <span class="s">&#34;pl&#34;</span><span class="p">,</span> <span class="s">&#34;pt&#34;</span><span class="p">,</span> <span class="s">&#34;ro&#34;</span><span class="p">,</span> <span class="s">&#34;ru&#34;</span><span class="p">,</span> <span class="s">&#34;ceb&#34;</span><span class="p">,</span> <span class="s">&#34;sr&#34;</span><span class="p">,</span> <span class="s">&#34;si&#34;</span><span class="p">,</span> <span class="s">&#34;sk&#34;</span><span class="p">,</span> <span class="s">&#34;sl&#34;</span><span class="p">,</span> <span class="s">&#34;sw&#34;</span><span class="p">,</span> <span class="s">&#34;su&#34;</span><span class="p">,</span> <span class="s">&#34;tg&#34;</span><span class="p">,</span> <span class="s">&#34;th&#34;</span><span class="p">,</span> <span class="s">&#34;tl&#34;</span><span class="p">,</span> <span class="s">&#34;ta&#34;</span><span class="p">,</span> <span class="s">&#34;tt&#34;</span><span class="p">,</span> <span class="s">&#34;te&#34;</span><span class="p">,</span> <span class="s">&#34;tr&#34;</span><span class="p">,</span> <span class="s">&#34;udm&#34;</span><span class="p">,</span> <span class="s">&#34;uz&#34;</span><span class="p">,</span> <span class="s">&#34;uk&#34;</span><span class="p">,</span> <span class="s">&#34;ur&#34;</span><span class="p">,</span> <span class="s">&#34;fi&#34;</span><span class="p">,</span> <span class="s">&#34;fr&#34;</span><span class="p">,</span> <span class="s">&#34;hi&#34;</span><span class="p">,</span> <span class="s">&#34;hr&#34;</span><span class="p">,</span> <span class="s">&#34;cs&#34;</span><span class="p">,</span> <span class="s">&#34;sv&#34;</span><span class="p">,</span> <span class="s">&#34;gd&#34;</span><span class="p">,</span> <span class="s">&#34;et&#34;</span><span class="p">,</span> <span class="s">&#34;eo&#34;</span><span class="p">,</span> <span class="s">&#34;jv&#34;</span><span class="p">,</span> <span class="s">&#34;ja&#34;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">   <span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="kt">string</span> <span class="n">HttpsServicePointTemplateUrl</span> <span class="p">=</span> <span class="s">&#34;https://translate.yandex.net/api/v1.5/tr.json/translate?key={3}&amp;text={2}&amp;lang={0}-{1}&amp;format=plain&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">private</span> <span class="kt">string</span> <span class="n">_key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="k">override</span> <span class="kt">string</span> <span class="n">Id</span> <span class="p">=&gt;</span> <span class="s">&#34;YandexTranslate&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="k">override</span> <span class="kt">string</span> <span class="n">FriendlyName</span> <span class="p">=&gt;</span> <span class="s">&#34;Yandex Translate&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="n">Initialize</span><span class="p">(</span> <span class="n">IInitializationContext</span> <span class="n">context</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">_key</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">GetOrCreateSetting</span><span class="p">(</span> <span class="s">&#34;Yandex&#34;</span><span class="p">,</span> <span class="s">&#34;YandexAPIKey&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">context</span><span class="p">.</span><span class="n">DisableCertificateChecksFor</span><span class="p">(</span> <span class="s">&#34;translate.yandex.net&#34;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="c1">// if the plugin cannot be enabled, simply throw so the user cannot select the plugin</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span><span class="p">(</span> <span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span> <span class="n">_key</span> <span class="p">)</span> <span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">Exception</span><span class="p">(</span> <span class="s">&#34;The YandexTranslate endpoint requires an API key which has not been provided.&#34;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span><span class="p">(</span> <span class="p">!</span><span class="n">SupportedLanguages</span><span class="p">.</span><span class="n">Contains</span><span class="p">(</span> <span class="n">context</span><span class="p">.</span><span class="n">SourceLanguage</span> <span class="p">)</span> <span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">Exception</span><span class="p">(</span> <span class="s">$&#34;The source language &#39;{context.SourceLanguage}&#39; is not supported.&#34;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span><span class="p">(</span> <span class="p">!</span><span class="n">SupportedLanguages</span><span class="p">.</span><span class="n">Contains</span><span class="p">(</span> <span class="n">context</span><span class="p">.</span><span class="n">DestinationLanguage</span> <span class="p">)</span> <span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">Exception</span><span class="p">(</span> <span class="s">$&#34;The destination language &#39;{context.DestinationLanguage}&#39; is not supported.&#34;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="n">OnCreateRequest</span><span class="p">(</span> <span class="n">IHttpRequestCreationContext</span> <span class="n">context</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kt">var</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="n">XUnityWebRequest</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">         <span class="kt">string</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">HttpsServicePointTemplateUrl</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">context</span><span class="p">.</span><span class="n">SourceLanguage</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">context</span><span class="p">.</span><span class="n">DestinationLanguage</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">WwwHelper</span><span class="p">.</span><span class="n">EscapeUrl</span><span class="p">(</span> <span class="n">context</span><span class="p">.</span><span class="n">UntranslatedText</span> <span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">_key</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">         
</span></span><span class="line"><span class="cl">      <span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">[</span> <span class="n">HttpRequestHeader</span><span class="p">.</span><span class="n">Accept</span> <span class="p">]</span> <span class="p">=</span> <span class="s">&#34;*/*&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">[</span> <span class="n">HttpRequestHeader</span><span class="p">.</span><span class="n">AcceptCharset</span> <span class="p">]</span> <span class="p">=</span> <span class="s">&#34;UTF-8&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">context</span><span class="p">.</span><span class="n">Complete</span><span class="p">(</span> <span class="n">request</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="n">OnExtractTranslation</span><span class="p">(</span> <span class="n">IHttpTranslationExtractionContext</span> <span class="n">context</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kt">var</span> <span class="n">data</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">Data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="kt">var</span> <span class="n">obj</span> <span class="p">=</span> <span class="n">JSON</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span> <span class="n">data</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="kt">var</span> <span class="n">code</span> <span class="p">=</span> <span class="n">obj</span><span class="p">.</span><span class="n">AsObject</span><span class="p">[</span> <span class="s">&#34;code&#34;</span> <span class="p">].</span><span class="n">ToString</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span><span class="p">(</span> <span class="n">code</span> <span class="p">!=</span> <span class="s">&#34;200&#34;</span> <span class="p">)</span> <span class="n">context</span><span class="p">.</span><span class="n">Fail</span><span class="p">(</span> <span class="s">&#34;Received bad response code: &#34;</span> <span class="p">+</span> <span class="n">code</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="kt">var</span> <span class="n">token</span> <span class="p">=</span> <span class="n">obj</span><span class="p">.</span><span class="n">AsObject</span><span class="p">[</span> <span class="s">&#34;text&#34;</span> <span class="p">].</span><span class="n">ToString</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="kt">var</span> <span class="n">translation</span> <span class="p">=</span> <span class="n">JsonHelper</span><span class="p">.</span><span class="n">Unescape</span><span class="p">(</span> <span class="n">token</span><span class="p">.</span><span class="n">Substring</span><span class="p">(</span> <span class="m">2</span><span class="p">,</span> <span class="n">token</span><span class="p">.</span><span class="n">Length</span> <span class="p">-</span> <span class="m">4</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">if</span><span class="p">(</span> <span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span> <span class="n">translation</span> <span class="p">)</span> <span class="p">)</span> <span class="n">context</span><span class="p">.</span><span class="n">Fail</span><span class="p">(</span> <span class="s">&#34;Received no translation.&#34;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">context</span><span class="p">.</span><span class="n">Complete</span><span class="p">(</span> <span class="n">translation</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This plugin extends from <code>HttpEndpoint</code>. Let&rsquo;s look at the three methods it overrides:</p>
<ul>
<li><code>Initialize</code> is used to read the API key the user has configured. In addition it calls <code>context.DisableCertificateChecksFor( &quot;translate.yandex.net&quot; )</code> in order to disable the certificate check for this specific hostname. If this is neglected, SSL will fail in most versions of Unity. Finally, it throws an exception if the plugin cannot be used with the specified configuration.</li>
<li><code>OnCreateRequest</code> is used to construct the <code>XUnityWebRequest</code> object that will be sent to the external endpoint. The call to <code>context.Complete( request )</code> specifies the request to use.</li>
<li><code>OnExtractTranslation</code> is used to extract the text from the response returned from the web server.</li>
</ul>
<p>As you can see, the <code>XUnityWebClient</code> class is not even used. We simply specify a request object that the <code>HttpEndpoint</code> will use internally to perform the request.</p>
<p>After implementing the class, simply build the project and place the generated DLL file in the &ldquo;Translators&rdquo; directory of the plugin folder. That&rsquo;s it.</p>
<p>For more examples of implementations, you can simply take a look at this projects source code.</p>
<p><strong>NOTE</strong>: If you implement a class based on the <code>HttpEndpoint</code> and you get an error where the web request is never completed, then it is likely due to the web server requiring Tls1.2. Unity-mono has issues with this spec and it will cause the request to lock up forever. The only solutions to this for now are:</p>
<ul>
<li>Disable SSL, if you can. There are many situations where it is simply not possible to do this because the web server will simply redirect back to the HTTPS endoint.</li>
<li>Use the <code>WwwEndpoint</code> instead. I highly advice against this though, unless it is an authenticated endpoint.</li>
</ul>
<p>Another way to implement a translator is to implement the <code>ExtProtocolEndpoint</code> class. This can be used to delegate the actual translation logic to an external process. Currently there is no documentation on this, but you can take a look at the LEC implementation, which uses it.</p>
<p>If instead, you use the interface directly, it is also possible to extend from MonoBehaviour to get access to all the normal lifecycle callbacks of Unity components.</p>
<h2 id="implementing-a-resource-redirector">Implementing a Resource Redirector</h2>
<p>The resource director allows you to modify resources loaded through the <code>Resources</code> and <code>AssetBundle</code> API as they are being loaded by the game.</p>
<p>The following API surface is made available by the Resource Redirector:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Entrypoint to the resource redirection API.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">ResourceRedirection</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets or sets a bool indicating if the resource redirector</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// should log all loaded resources/assets to the console.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="n">LogAllLoadedResources</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Register an AssetLoading hook (prefix to loading an asset from an asset bundle).</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;priority&#34;&gt;The priority of the callback, the higher the sooner it will be called.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;action&#34;&gt;The callback.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">RegisterAssetLoadingHook</span><span class="p">(</span> <span class="kt">int</span> <span class="n">priority</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">AssetLoadingContext</span><span class="p">&gt;</span> <span class="n">action</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Unregister an AssetLoading hook (prefix to loading an asset from an asset bundle).</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;action&#34;&gt;The callback.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">UnregisterAssetLoadingHook</span><span class="p">(</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">AssetLoadingContext</span><span class="p">&gt;</span> <span class="n">action</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Register an AsyncAssetLoading hook (prefix to loading an asset from an asset bundle asynchronously).</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;priority&#34;&gt;The priority of the callback, the higher the sooner it will be called.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;action&#34;&gt;The callback.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">RegisterAsyncAssetLoadingHook</span><span class="p">(</span> <span class="kt">int</span> <span class="n">priority</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">AsyncAssetLoadingContext</span><span class="p">&gt;</span> <span class="n">action</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Unregister an AsyncAssetLoading hook (prefix to loading an asset from an asset bundle asynchronously).</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;action&#34;&gt;The callback.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">UnregisterAsyncAssetLoadingHook</span><span class="p">(</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">AsyncAssetLoadingContext</span><span class="p">&gt;</span> <span class="n">action</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Register an AsyncAssetLoading hook and AssetLoading hook (prefix to loading an asset from an asset bundle synchronously/asynchronously).</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;priority&#34;&gt;The priority of the callback, the higher the sooner it will be called.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;action&#34;&gt;The callback.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">RegisterAsyncAndSyncAssetLoadingHook</span><span class="p">(</span> <span class="kt">int</span> <span class="n">priority</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">IAssetLoadingContext</span><span class="p">&gt;</span> <span class="n">action</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Unregister an AsyncAssetLoading hook and AssetLoading hook (prefix to loading an asset from an asset bundle synchronously/asynchronously).</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;action&#34;&gt;The callback.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">UnregisterAsyncAndSyncAssetLoadingHook</span><span class="p">(</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">IAssetLoadingContext</span><span class="p">&gt;</span> <span class="n">action</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Register an AssetLoaded hook (postfix to loading an asset from an asset bundle (both synchronous and asynchronous)).</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;behaviour&#34;&gt;The behaviour of the callback.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;priority&#34;&gt;The priority of the callback, the higher the sooner it will be called.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;action&#34;&gt;The callback.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">RegisterAssetLoadedHook</span><span class="p">(</span> <span class="n">HookBehaviour</span> <span class="n">behaviour</span><span class="p">,</span> <span class="kt">int</span> <span class="n">priority</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">AssetLoadedContext</span><span class="p">&gt;</span> <span class="n">action</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Unregister an AssetLoaded hook (postfix to loading an asset from an asset bundle (both synchronous and asynchronous)).</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;action&#34;&gt;The callback.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">UnregisterAssetLoadedHook</span><span class="p">(</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">AssetLoadedContext</span><span class="p">&gt;</span> <span class="n">action</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Register an AssetBundleLoading hook (prefix to loading an asset bundle synchronously).</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;priority&#34;&gt;The priority of the callback, the higher the sooner it will be called.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;action&#34;&gt;The callback.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">RegisterAssetBundleLoadingHook</span><span class="p">(</span> <span class="kt">int</span> <span class="n">priority</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">AssetBundleLoadingContext</span><span class="p">&gt;</span> <span class="n">action</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Unregister an AssetBundleLoading hook (prefix to loading an asset bundle synchronously).</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;action&#34;&gt;The callback.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">UnregisterAssetBundleLoadingHook</span><span class="p">(</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">AssetBundleLoadingContext</span><span class="p">&gt;</span> <span class="n">action</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Register an AsyncAssetBundleLoading hook (prefix to loading an asset bundle asynchronously).</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;priority&#34;&gt;The priority of the callback, the higher the sooner it will be called.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;action&#34;&gt;The callback.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">RegisterAsyncAssetBundleLoadingHook</span><span class="p">(</span> <span class="kt">int</span> <span class="n">priority</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">AsyncAssetBundleLoadingContext</span><span class="p">&gt;</span> <span class="n">action</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Unregister an AsyncAssetBundleLoading hook (prefix to loading an asset bundle asynchronously).</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;action&#34;&gt;The callback.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">UnregisterAsyncAssetBundleLoadingHook</span><span class="p">(</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">AsyncAssetBundleLoadingContext</span><span class="p">&gt;</span> <span class="n">action</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Register an AsyncAssetBundleLoading hook and AssetBundleLoading hook (prefix to loading an asset bundle synchronously/asynchronously).</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;priority&#34;&gt;The priority of the callback, the higher the sooner it will be called.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;action&#34;&gt;The callback.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">RegisterAsyncAndSyncAssetBundleLoadingHook</span><span class="p">(</span> <span class="kt">int</span> <span class="n">priority</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">IAssetBundleLoadingContext</span><span class="p">&gt;</span> <span class="n">action</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Unregister an AsyncAssetBundleLoading hook and AssetBundleLoading hook (prefix to loading an asset bundle synchronously/asynchronously).</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;action&#34;&gt;The callback.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">UnregisterAsyncAndSyncAssetBundleLoadingHook</span><span class="p">(</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">IAssetBundleLoadingContext</span><span class="p">&gt;</span> <span class="n">action</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Register a ReourceLoaded hook (postfix to loading a resource from the Resources API (both synchronous and asynchronous)).</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;behaviour&#34;&gt;The behaviour of the callback.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;priority&#34;&gt;The priority of the callback, the higher the sooner it will be called.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;action&#34;&gt;The callback.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">RegisterResourceLoadedHook</span><span class="p">(</span> <span class="n">HookBehaviour</span> <span class="n">behaviour</span><span class="p">,</span> <span class="kt">int</span> <span class="n">priority</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">ResourceLoadedContext</span><span class="p">&gt;</span> <span class="n">action</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Unregister a ReourceLoaded hook (postfix to loading a resource from the Resources API (both synchronous and asynchronous)).</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;action&#34;&gt;The callback.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">UnregisterResourceLoadedHook</span><span class="p">(</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">ResourceLoadedContext</span><span class="p">&gt;</span> <span class="n">action</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Enables experimental hooks that allows returning an Asset instead of a Request from async prefix</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// asset load operations.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">EnableSyncOverAsyncAssetLoads</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Disables all recursive behaviour in the plugin. This means that trying to load an asset</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// using the hooked APIs will not trigger a callback back into the callback chain. This makes</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// setting the correct priorities on callbacks much more important.</span>
</span></span><span class="line"><span class="cl">    <span class="c1">///</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// This method should not be called lightly. It should not be something a single plugin randomly</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// decides to call, but rather decision for how to use the ResourceRedirection API on a game-wide basis.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">DisableRecursionPermanently</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Creates an asset bundle hook that attempts to load asset bundles in the emulation directory</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// over the default asset bundles if they exist.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;hookPriority&#34;&gt;Priority of the hook.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;emulationDirectory&#34;&gt;The directory to look for the asset bundles in.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">EnableEmulateAssetBundles</span><span class="p">(</span> <span class="kt">int</span> <span class="n">hookPriority</span><span class="p">,</span> <span class="kt">string</span> <span class="n">emulationDirectory</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Disable a previously enabled asset bundle emulation.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">DisableEmulateAssetBundles</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Creates an asset bundle hook that redirects asset bundles loads to an empty</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// asset bundle if the file that is being loaded does not exist.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;hookPriority&#34;&gt;Priority of the hook.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">EnableRedirectMissingAssetBundlesToEmptyAssetBundle</span><span class="p">(</span> <span class="kt">int</span> <span class="n">hookPriority</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Disable a previously enabled redirect missing asset bundles to empty asset bundle.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">DisableRedirectMissingAssetBundlesToEmptyAssetBundle</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s attach some comments to this API.</p>
<h3 id="asset-loadingloaded-methods">Asset Loading/Loaded Methods</h3>
<p>The resource redirector comes with both postfix and prefix callbacks when loading an asset from the <code>AssetBundle</code> API.</p>
<p>The event callback chain looks like this <code>[AssetLoading / AsyncAssetLoading hooks] =&gt; [Original Method] =&gt; [AssetLoaded hooks]</code>. The <code>AssetLoaded</code> event handles postfixes for both synchronous and asynchronous loading of assets.</p>
<h4 id="asset-loading-methods">Asset Loading Methods</h4>
<p>The methods <code>RegisterAssetLoadingHook( HookBehaviour behaviour, Action&lt;AssetLoadingContext&gt; action )</code> and <code>RegisterAsyncAssetLoadingHook( int priority, Action&lt;AsyncAssetLoadingContext&gt; action )</code> hooks into the <code>AssetBundle</code> API when loading assets.</p>
<p>These methods registers prefix callbacks, which means the assets themselves wont be loaded yet when they are called.</p>
<p>The callbacks take the types <code>AssetLoadingContext</code> and <code>AsyncAssetLoadingContext</code> as an argument, respectively. Let&rsquo;s take a look at their definitions:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// The operation context surrounding the AssetLoading hook (synchronous).</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">AssetLoadingContext</span> <span class="p">:</span> <span class="n">IAssetLoadingContext</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the original path the asset bundle was loaded with.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;returns&gt;The unmodified, original path the asset bundle was loaded with.&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">string</span> <span class="n">GetAssetBundlePath</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the normalized path to the asset bundle that is:</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///  * Relative to the current directory</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///  * Lower-casing</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///  * Uses &#39;\&#39; as separators.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;returns&gt;&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">string</span> <span class="n">GetNormalizedAssetBundlePath</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicate your work is done and if any other hooks to this asset/resource load should be called.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;skipRemainingPrefixes&#34;&gt;Indicate if the remaining prefixes should be skipped.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;skipOriginalCall&#34;&gt;Indicate if the original call should be skipped. If you set the asset, you likely want to set this to true.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;skipAllPostfixes&#34;&gt;Indicate if the postfixes should be skipped.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">Complete</span><span class="p">(</span> <span class="kt">bool</span> <span class="n">skipRemainingPrefixes</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="kt">bool?</span> <span class="n">skipOriginalCall</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="kt">bool?</span> <span class="n">skipAllPostfixes</span> <span class="p">=</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Disables recursive calls if you make an asset/asset bundle load call</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// from within your callback. If you want to prevent recursion this should</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// be called before you load the asset/asset bundle.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">DisableRecursion</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the original parameters the asset load call was called with.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">AssetLoadingParameters</span> <span class="n">Parameters</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the AssetBundle associated with the loaded assets.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">AssetBundle</span> <span class="n">Bundle</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets or sets the loaded assets.</span>
</span></span><span class="line"><span class="cl">    <span class="c1">///</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Consider using this if the load type is &#39;LoadByType&#39; or &#39;LoadNamedWithSubAssets&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">UnityEngine</span><span class="p">.</span><span class="n">Object</span><span class="p">[]</span> <span class="n">Assets</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets or sets the loaded assets. This is simply equal to the first index of the Assets property, with some</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// additional null guards to prevent NullReferenceExceptions when using it.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">UnityEngine</span><span class="p">.</span><span class="n">Object</span> <span class="n">Asset</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// The operation context surrounding the AsyncAssetLoading hook (asynchronous).</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">AsyncAssetLoadingContext</span> <span class="p">:</span> <span class="n">IAssetLoadingContext</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the original path the asset bundle was loaded with.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;returns&gt;The unmodified, original path the asset bundle was loaded with.&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">string</span> <span class="n">GetAssetBundlePath</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the normalized path to the asset bundle that is:</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///  * Relative to the current directory</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///  * Lower-casing</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///  * Uses &#39;\&#39; as separators.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;returns&gt;&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">string</span> <span class="n">GetNormalizedAssetBundlePath</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicate your work is done and if any other hooks to this asset/resource load should be called.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;skipRemainingPrefixes&#34;&gt;Indicate if the remaining prefixes should be skipped.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;skipOriginalCall&#34;&gt;Indicate if the original call should be skipped. If you set the asset, you likely want to set this to true.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;skipAllPostfixes&#34;&gt;Indicate if the postfixes should be skipped.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">Complete</span><span class="p">(</span> <span class="kt">bool</span> <span class="n">skipRemainingPrefixes</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="kt">bool?</span> <span class="n">skipOriginalCall</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="kt">bool?</span> <span class="n">skipAllPostfixes</span> <span class="p">=</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Disables recursive calls if you make an asset/asset bundle load call</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// from within your callback. If you want to prevent recursion this should</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// be called before you load the asset/asset bundle.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">DisableRecursion</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the original parameters the asset load call was called with.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">AssetLoadingParameters</span> <span class="n">Parameters</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the AssetBundle associated with the loaded assets.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">AssetBundle</span> <span class="n">Bundle</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets or sets the AssetBundleRequest used to load assets.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">AssetBundleRequest</span> <span class="n">Request</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets or sets the loaded assets.</span>
</span></span><span class="line"><span class="cl">    <span class="c1">///</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Consider using this if the load type is &#39;LoadByType&#39; or &#39;LoadNamedWithSubAssets&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">UnityEngine</span><span class="p">.</span><span class="n">Object</span><span class="p">[]</span> <span class="n">Assets</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets or sets the loaded assets. This is simply equal to the first index of the Assets property, with some</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// additional null guards to prevent NullReferenceExceptions when using it.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">UnityEngine</span><span class="p">.</span><span class="n">Object</span> <span class="n">Asset</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets or sets how this load operation should be resolved.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Setting the Asset/Assets/Request property will automatically update this value.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">AsyncAssetLoadingResolve</span> <span class="n">ResolveType</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The only difference between these two contexts is that one has an <code>Asset/Assets</code> property you can set, while the other has a <code>Request</code> property you can set.</p>
<p>Now if you actually paid attention to what you were reading(!?), you would notice that both of the above context objects has an <code>Asset/Assets</code> property that can be set.</p>
<p>Under normal circumstances, however, you cannot use the <code>Assets/Asset</code> property on the the <code>AsyncAssetLoadingContext</code>. In order to be able to use these, you must first call <code>ResourceRedirection.EnableSyncOverAsyncAssetLoads</code> once during your initialization logic. This will allow you to set the asset directly so you don&rsquo;t have to go through the standard <code>AssetBundle</code> API to obtain a request object.</p>
<p>It is, however, recommended that if you can that you set the <code>Request</code> property instead of the <code>Assets/Asset</code> property as that will keep the operation asynchronous and not block the game while the asset is being loaded.</p>
<p>If you can handle the loading of the asset remember to call the <code>Complete</code> method to indicate your intentions regarding:</p>
<ul>
<li>Whether the rest of the prefixes registered should be skipped.</li>
<li>Whether the original method should be skipped.</li>
<li>Whether all the postfixes should be skipped.</li>
</ul>
<p>An important points to make here, is that there is both an <code>Asset</code> and an <code>Assets</code> property on the context object. These can be used interchangably, but an array will only ever be used if the following condition apply:</p>
<ul>
<li>The <code>LoadType</code> in the <code>Parameters</code> property is <code>LoadByType</code> or <code>LoadNamedWithSubAssets</code>, which are the only types of resource loading that may return multiple resources.</li>
</ul>
<p>Finally, if we take a look at the <code>Parameters</code> property of the context object, we will find the following definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Class representing the original parameters of the load call.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">AssetLoadingParameters</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets or sets the name of the asset being loaded. Will be null if loaded through &#39;LoadMainAsset&#39; or &#39;LoadByType&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets or sets the type that passed to the asset load call.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">Type</span> <span class="n">Type</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the type of call that loaded this asset. If &#39;LoadByType&#39; or &#39;LoadNamedWithSubAssets&#39; is specified</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// multiple assets may be returned if subscribed as &#39;OneCallbackPerLoadCall&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">AssetLoadType</span> <span class="n">LoadType</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Enum representing the different ways an asset may be loaded.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">enum</span> <span class="n">AssetLoadType</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicates that this asset has been loaded as the &#39;mainAsset&#39; in the AssetBundle API.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">LoadMainAsset</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicates that this call is loading all assets of a specific type in an AssetBundle API.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">LoadByType</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicates that this call is loading a specific named asset in the AssetBundle API.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">LoadNamed</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicates that this call is loading a specific named asset and all those below it in the AssetBundle API.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">LoadNamedWithSubAssets</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Another way to change the result of the asset load operation is to change the value of the <code>Name</code> and <code>Type</code> properties in the <code>Parameters</code> property. If you do this, you likely will not want to call the Complete method, as you will want the original method to still be called.</p>
<p>An important additional way to subscribe to the prefix asset loading operations are through the method <code>RegisterAsyncAndSyncAssetLoadingHook( int priority, Action&lt;IAssetLoadingContext&gt; action )</code>. This method will handle both async and sync asset loading operations. The <code>IAssetLoadingContext</code> is an interface implemented by both the <code>AssetLoadingContext</code> and <code>AsyncAssetLoadingContext</code>.</p>
<p>Do note, that if you want to use this method you must first call the method <code>EnableSyncOverAsyncAssetLoads()</code> to enable the hooks required for this to work.</p>
<h4 id="asset-loaded-methods">Asset Loaded Methods</h4>
<p>The method <code>RegisterAssetLoadedHook( HookBehaviour behaviour, Action&lt;AssetLoadedContext&gt; action )</code> hooks into the <code>AssetBundle</code> API in the UnityEngine. Any time an asset is loaded through this API a callback is sent to these hooks.</p>
<p>This API is a postfix hook to the <code>AssetBundle</code> API, which means that it is first called once the original asset has already been loaded, but is still replacable.</p>
<p>The <code>AssetLoadedContext</code> class has the following definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// The operation context surrounding the AssetLoaded hook.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">AssetLoadedContext</span> <span class="p">:</span> <span class="n">IAssetOrResourceLoadedContext</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets a bool indicating if this resource has already been redirected before.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">bool</span> <span class="n">HasReferenceBeenRedirectedBefore</span><span class="p">(</span> <span class="n">UnityEngine</span><span class="p">.</span><span class="n">Object</span> <span class="n">asset</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets a file system path for the specfic asset that should be unique.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;asset&#34;&gt;&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;returns&gt;&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">string</span> <span class="n">GetUniqueFileSystemAssetPath</span><span class="p">(</span> <span class="n">UnityEngine</span><span class="p">.</span><span class="n">Object</span> <span class="n">asset</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the original path the asset bundle was loaded with.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;returns&gt;The unmodified, original path the asset bundle was loaded with.&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">string</span> <span class="n">GetAssetBundlePath</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the normalized path to the asset bundle that is:</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///  * Relative to the current directory</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///  * Lower-casing</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///  * Uses &#39;\&#39; as separators.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;returns&gt;&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">string</span> <span class="n">GetNormalizedAssetBundlePath</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicate your work is done and if any other hooks to this asset/resource load should be called.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;skipRemainingPostfixes&#34;&gt;Indicate if any other hooks should be skipped.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">Complete</span><span class="p">(</span> <span class="kt">bool</span> <span class="n">skipRemainingPostfixes</span> <span class="p">=</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Disables recursive calls if you make an asset/asset bundle load call</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// from within your callback. If you want to prevent recursion this should</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// be called before you load the asset/asset bundle.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">DisableRecursion</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the original parameters the asset load call was called with.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">AssetLoadedParameters</span> <span class="n">Parameters</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the AssetBundle associated with the loaded assets.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">AssetBundle</span> <span class="n">Bundle</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the loaded assets. Override individual indices to change the asset reference that will be loaded.</span>
</span></span><span class="line"><span class="cl">    <span class="c1">///</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Consider using this if the load type is &#39;LoadByType&#39; or &#39;LoadNamedWithSubAssets&#39; and you subscribed with &#39;OneCallbackPerLoadCall&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">UnityEngine</span><span class="p">.</span><span class="n">Object</span><span class="p">[]</span> <span class="n">Assets</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the loaded asset. This is simply equal to the first index of the Assets property, with some</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// additional null guards to prevent NullReferenceExceptions when using it.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">UnityEngine</span><span class="p">.</span><span class="n">Object</span> <span class="n">Asset</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The HookBehaviour is an enum with the following definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Enum indicating how the resource redirector should treat the callback.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">enum</span> <span class="n">HookBehaviour</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Specifies that exactly one callback should be received per call to asset/resource load method.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">OneCallbackPerLoadCall</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Specifies that exactly one callback should be received per loaded asset/resources. This means</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// that the &#39;Asset&#39; property should be used over the &#39;Assets&#39; property on the context object.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Do note that when using this option, if no resources are returned by a load call, no callbacks</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// will be received.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">OneCallbackPerResourceLoaded</span> <span class="p">=</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>An important points to make here, is that there is both an <code>Asset</code> and an <code>Assets</code> property on the context object. These can be used interchangably, but an array will only ever be used if the following two conditions apply:</p>
<ul>
<li>You&rsquo;ve subscribed with <code>OneCallbackPerLoadCall</code>.</li>
<li>The <code>LoadType</code> in the <code>Parameters</code> property is <code>LoadByType</code> or <code>LoadNamedWithSubAssets</code>, which are the only types of resource loading that may return multiple resources.</li>
</ul>
<p>In relation to this, it is worth mentioning that if a call to load assets returns 0 assets, you will not receive any callbacks if you subscribe through <code>OneCallbackPerResourceLoaded</code> where as if you subscribe through <code>OneCallbackPerLoadCall</code> you would still get your one callback.</p>
<p>If you update or replace the asset being loaded remember to call to <code>Complete</code> method to indicate your intentions regarding:</p>
<ul>
<li>Whether the remaining postfixes should be called.</li>
</ul>
<p>In addition, if we take a look at the <code>Parameters</code> property of the context object, we will find the following definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Class representing the original parameters of the load call.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">AssetLoadedParameters</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the name of the asset being loaded. Will be null if loaded through &#39;LoadMainAsset&#39; or &#39;LoadByType&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the type that passed to the asset load call.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">Type</span> <span class="n">Type</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the type of call that loaded this asset. If &#39;LoadByType&#39; or &#39;LoadNamedWithSubAssets&#39; is specified</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// multiple assets may be returned if subscribed as &#39;OneCallbackPerLoadCall&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">AssetLoadType</span> <span class="n">LoadType</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Enum representing the different ways an asset may be loaded.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">enum</span> <span class="n">AssetLoadType</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicates that this asset has been loaded as the &#39;mainAsset&#39; in the AssetBundle API.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">LoadMainAsset</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicates that this call is loading all assets of a specific type in an AssetBundle API.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">LoadByType</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicates that this call is loading a specific named asset in the AssetBundle API.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">LoadNamed</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicates that this call is loading a specific named asset and all those below it in the AssetBundle API.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">LoadNamedWithSubAssets</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>It is also worth mentioning that these hooks handles both synchronous and asynchronous loading of assets.</p>
<p>Hooks subscribed through hook behaviour <code>OneCallbackPerLoadCall</code> will be called before hooks with the behaviour <code>OneCallbackPerResourceLoaded</code>.</p>
<h3 id="resource-load-methods">Resource Load Methods</h3>
<p>The resource redirector comes only with postfix callbacks when loading an asset from the <code>Resources</code> API.</p>
<p>The event callback chain looks like this <code>[Original Method] =&gt; [ResourceLoaded hooks]</code>. The <code>ResourceLoaded</code> event handles postfixes for both synchronous and asynchronous loading of assets.</p>
<h4 id="resource-loaded-methods">Resource Loaded Methods</h4>
<p>The method <code>RegisterResourceLoadedHook( HookBehaviour behaviour, Action&lt;ResourceLoadedContext&gt; action )</code> hooks into the <code>Resources</code> API in the UnityEngine. Any time a resource is loaded through this API a callback is sent to these hooks.</p>
<p>This API is a postfix hook to the <code>Resources</code> API, which means that it is first called once the original asset has already been loaded, but is still replacable.</p>
<p>The <code>ResourceLoadedContext</code> class has the following definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// The operation context surrounding the ResourceLoaded hook.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">ResourceLoadedContext</span> <span class="p">:</span> <span class="n">IAssetOrResourceLoadedContext</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets a bool indicating if this resource has already been redirected before.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">bool</span> <span class="n">HasReferenceBeenRedirectedBefore</span><span class="p">(</span> <span class="n">UnityEngine</span><span class="p">.</span><span class="n">Object</span> <span class="n">asset</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets a file system path for the specfic asset that should be unique.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;asset&#34;&gt;&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;returns&gt;&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">string</span> <span class="n">GetUniqueFileSystemAssetPath</span><span class="p">(</span> <span class="n">UnityEngine</span><span class="p">.</span><span class="n">Object</span> <span class="n">asset</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicate your work is done and if any other hooks to this asset/resource load should be called.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;skipRemainingPostfixes&#34;&gt;Indicate if any other hooks should be skipped.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">Complete</span><span class="p">(</span> <span class="kt">bool</span> <span class="n">skipRemainingPostfixes</span> <span class="p">=</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Disables recursive calls if you make an asset/asset bundle load call</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// from within your callback. If you want to prevent recursion this should</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// be called before you load the asset/asset bundle.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">DisableRecursion</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the original parameters the asset load call was called with.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">ResourceLoadParameters</span> <span class="n">Parameters</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the loaded assets. Override individual indices to change the asset reference that will be loaded.</span>
</span></span><span class="line"><span class="cl">    <span class="c1">///</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Consider using this if the load type is &#39;LoadByType&#39; and you subscribed with &#39;OneCallbackPerLoadCall&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">UnityEngine</span><span class="p">.</span><span class="n">Object</span><span class="p">[]</span> <span class="n">Assets</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the loaded asset. This is simply equal to the first index of the Assets property, with some</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// additional null guards to prevent NullReferenceExceptions when using it.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">UnityEngine</span><span class="p">.</span><span class="n">Object</span> <span class="n">Asset</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The HookBehaviour is an enum with the following definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Enum indicating how the resource redirector should treat the callback.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">enum</span> <span class="n">HookBehaviour</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Specifies that exactly one callback should be received per call to asset/resource load method.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">OneCallbackPerLoadCall</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Specifies that exactly one callback should be received per loaded asset/resources. This means</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// that the &#39;Asset&#39; property should be used over the &#39;Assets&#39; property on the context object.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Do note that when using this option, if no resources are returned by a load call, no callbacks</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// will be received.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">OneCallbackPerResourceLoaded</span> <span class="p">=</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>An important points to make here, is that there is both an <code>Asset</code> and an <code>Assets</code> property on the context object. These can be used interchangably, but an array will only ever be used if the following two conditions apply:</p>
<ul>
<li>You&rsquo;ve subscribed with <code>OneCallbackPerLoadCall</code>.</li>
<li>The <code>LoadType</code> in the <code>Parameters</code> property is <code>LoadByType</code>, which is the only type of resource loading that may return multiple resources.</li>
</ul>
<p>In relation to this, it is worth mentioning that if a call to load assets returns 0 assets, you will not receive any callbacks if you subscribe through <code>OneCallbackPerResourceLoaded</code> where as if you subscribe through <code>OneCallbackPerLoadCall</code> you would still get your one callback.</p>
<p>If you update or replace the asset being loaded remember to call to <code>Complete</code> method to indicate your intentions regarding:</p>
<ul>
<li>Whether the remaining postfixes should be called.</li>
</ul>
<p>In addition, if we take a look at the <code>Parameters</code> property of the context object, we will find the following definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Class representing the original parameters of the load call.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">ResourceLoadedParameters</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the name of the resource being loaded. Will not be the complete resource path if &#39;LoadByType&#39; is used.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">string</span> <span class="n">Path</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the type that passed to the resource load call.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">Type</span> <span class="n">Type</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the type of call that loaded this asset. If &#39;LoadByType&#39; is specified</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// multiple assets may be returned if subscribed as &#39;OneCallbackPerLoadCall&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">ResourceLoadType</span> <span class="n">LoadType</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Enum representing the different ways a resource may be loaded.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">enum</span> <span class="n">ResourceLoadType</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicates that this call is loading all assets of a specific type (below a specific path) in the Resources API.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">LoadByType</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicates that this call is loading a single named asset in the Resources API.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">LoadNamed</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicates that this call is loading a single named built-in asset in the Resources API.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">LoadNamedBuiltIn</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>It is also worth mentioning that these hooks handles both synchronous and asynchronous loading of resources.</p>
<p>Hooks subscribed through hook behaviour <code>OneCallbackPerLoadCall</code> will be called before hooks with the behaviour <code>OneCallbackPerResourceLoaded</code>.</p>
<h3 id="assetbundle-load-methods">AssetBundle Load Methods</h3>
<p>It is also possible to hook the loading of <code>AssetBundles</code> themselves. Only prefix hooks are supported when loading an asset bundle.</p>
<p>The event callback chain looks like this <code>[AssetBundleLoading/AsyncAssetBundleLoading hooks] =&gt; [Original Method]</code>.</p>
<h4 id="assetbundle-synchrous-load-methods">AssetBundle Synchrous Load Methods</h4>
<p>The method <code>RegisterAssetBundleLoadingHook( Action&lt;AssetBundleLoadingContext&gt; action )</code> is used to hook the synchronous AssetBundle load methods.</p>
<p>This API is a prefix to the <code>AssetBundle</code> API, which means that it is called before the AssetBundle is loaded.</p>
<p>The <code>AssetBundleLoadingContext</code> class has the following definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// The operation context surrounding the AssetBundleLoading hook (synchronous).</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">AssetBundleLoadingContext</span> <span class="p">:</span> <span class="n">IAssetBundleLoadingContext</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets a normalized path to the asset bundle that is:</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///  * Relative to the current directory</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///  * Lower-casing</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///  * Uses &#39;\&#39; as separators.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;returns&gt;&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">string</span> <span class="n">GetNormalizedPath</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicate your work is done and if any other hooks to this asset bundle load should be called.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;skipRemainingPrefixes&#34;&gt;Indicate if the remaining prefixes should be skipped.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;skipOriginalCall&#34;&gt;Indicate if the original call should be skipped. If you set the asset bundle, you likely want to set this to true.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">Complete</span><span class="p">(</span> <span class="kt">bool</span> <span class="n">skipRemainingPrefixes</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="kt">bool?</span> <span class="n">skipOriginalCall</span> <span class="p">=</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Disables recursive calls if you make an asset/asset bundle load call</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// from within your callback. If you want to prevent recursion this should</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// be called before you load the asset/asset bundle.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">DisableRecursion</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the parameters of the call.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">AssetBundleLoadingParameters</span> <span class="n">Parameters</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets or sets the AssetBundle being loaded.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">AssetBundle</span> <span class="n">Bundle</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Because this is a prefix API, the <code>Bundle</code> property will be null when the method is called and it is up to you to set it to a different value if you can handle the specified path.</p>
<p>If you update the <code>Bundle</code> property, remember to call the <code>Complete</code> to indicate your intentions regarding:</p>
<ul>
<li>Whether or not the remaining prefixes should be skipped.</li>
<li>Whether or not the original method should be skipped.</li>
</ul>
<p>In addition, if we take a look at the <code>Parameters</code> property of the context object, we will find the following definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Class representing the original parameters of the load call.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">AssetBundleLoadingParameters</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets or sets the loaded path. Only relevant for &#39;LoadFromFile&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">string</span> <span class="n">Path</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets or sets the crc. Only relevant for &#39;LoadFromFile&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">uint</span> <span class="n">Crc</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets or sets the offset. Only relevant for &#39;LoadFromFile&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">ulong</span> <span class="n">Offset</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the type of call that is loading this asset bundle.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">AssetBundleLoadType</span> <span class="n">LoadType</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Enum representing the different ways an asset bundle may be loaded.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">enum</span> <span class="n">AssetBundleLoadType</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicates that the asset bundle is being loaded through a call to &#39;LoadFromFile&#39; or &#39;LoadFromFileAsync&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">LoadFromFile</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>As can be seen, the current implementation only hooks the LoadFromFile/LoadFromFileAsync ways of loading AssetBundles, but this may be expanded in the future.</p>
<p>It may also be worth looking at the <code>GetNormalizedPath()</code> method instead of the <code>Path</code> property of the original call parameters. This is because the path passed to the method can take literally any form:</p>
<ul>
<li>Absolute path</li>
<li>Relative path</li>
<li>Include a stray &lsquo;..&rsquo; in the middle of the path</li>
</ul>
<p>Another way to change the result of the asset bundle load operation is to change the value of the <code>Path</code>, <code>Crc</code> and <code>Offset</code> properties in the <code>Parameters</code> property. If you do this, you likely will not want to call the Complete method, as you will want the original method to still be called.</p>
<h4 id="assetbundle-asynchrounous-load-methods">AssetBundle Asynchrounous Load Methods</h4>
<p>The method <code>RegisterAsyncAssetBundleLoadingHook( Action&lt;AsyncAssetBundleLoadingContext&gt; action )</code> is used to hook the asynchronous AssetBundle load methods.</p>
<p>This API is a prefix to the <code>AssetBundle</code> API, which means that it is called before the <code>AssetBundleCreateRequest</code> is created.</p>
<p>The <code>AsyncAssetBundleLoadingContext</code> class has the following definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// The operation context surrounding the AsyncAssetBundleLoading hook (asynchronous).</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">AsyncAssetBundleLoadingContext</span> <span class="p">:</span> <span class="n">IAssetBundleLoadingContext</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets a normalized path to the asset bundle that is:</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///  * Relative to the current directory</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///  * Lower-casing</span>
</span></span><span class="line"><span class="cl">    <span class="cs">///  * Uses &#39;\&#39; as separators.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;returns&gt;&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">string</span> <span class="n">GetNormalizedPath</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicate your work is done and if any other hooks to this asset bundle load should be called.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;skipRemainingPrefixes&#34;&gt;Indicate if the remaining prefixes should be skipped.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;skipOriginalCall&#34;&gt;Indicate if the original call should be skipped. If you set the request, you likely want to set this to true.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">Complete</span><span class="p">(</span> <span class="kt">bool</span> <span class="n">skipRemainingPrefixes</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="kt">bool?</span> <span class="n">skipOriginalCall</span> <span class="p">=</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Disables recursive calls if you make an asset/asset bundle load call</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// from within your callback. If you want to prevent recursion this should</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// be called before you load the asset/asset bundle.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">DisableRecursion</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the parameters of the call.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">AssetBundleLoadingParameters</span> <span class="n">Parameters</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets or sets the AssetBundleCreateRequest being used to load the AssetBundle.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">AssetBundleCreateRequest</span> <span class="n">Request</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets or sets the AssetBundle being loaded.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">AssetBundle</span> <span class="n">Bundle</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets or sets how this load operation should be resolved.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Setting the Bundle/Request property will automatically update this value.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">AsyncAssetBundleLoadingResolve</span> <span class="n">ResolveType</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Because this is a prefix API, the <code>Request</code> property will be null when the method is called and it is up to you to set it to a different value if you can handle the specified path.</p>
<p>As you can see there is actually also a <code>Bundle</code> property available on the context object. Under normal circumstances, however, you cannot use the <code>Bundle</code> property on the the <code>AsyncAssetBundleLoadingContext</code>. In order to be able to use these, you must first call <code>ResourceRedirection.EnableSyncOverAsyncAssetLoads</code> once during your initialization logic. This will allow you to set the bundle directly so you don&rsquo;t have to go through the standard <code>AssetBundle</code> API to obtain a request object.</p>
<p>It is, however, recommended that if you can that you set the <code>Request</code> property instead of the <code>Bundle</code> property as that will keep the operation asynchronous and not block the game while the asset is being loaded.</p>
<p>If you update the <code>Request</code> property, remember to call the <code>Complete</code> to indicate your intentions regarding:</p>
<ul>
<li>Whether or not the remaining prefixes should be skipped.</li>
<li>Whether or not the original method should be skipped.</li>
</ul>
<p>In addition, if we take a look at the <code>Parameters</code> property of the context object, we will find the following definition:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Class representing the original parameters of the load call.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">AssetBundleLoadingParameters</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the loaded path. Only relevant for &#39;LoadFromFile&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">string</span> <span class="n">Path</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the crc. Only relevant for &#39;LoadFromFile&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">uint</span> <span class="n">Crc</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the offset. Only relevant for &#39;LoadFromFile&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">ulong</span> <span class="n">Offset</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the type of call that is loading this asset bundle.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">AssetBundleLoadType</span> <span class="n">LoadType</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Enum representing the different ways an asset bundle may be loaded.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">enum</span> <span class="n">AssetBundleLoadType</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicates that the asset bundle is being loaded through a call to &#39;LoadFromFile&#39; or &#39;LoadFromFileAsync&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">LoadFromFile</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>As can be see, the current implementation only hooks the LoadFromFile/LoadFromFileAsync ways of loading AssetBundles, but this may be expanded in the future.</p>
<p>It may also be worth looking at the <code>GetNormalizedPath()</code> method instead of the <code>Path</code> property of the original call parameters. This is because the path passed to the method can take literally any form:</p>
<ul>
<li>Absolute path</li>
<li>Relative path</li>
<li>Include a stray &lsquo;..&rsquo; in the middle of the path</li>
</ul>
<p>Another way to change the result of the asset bundle load operation is to change the value of the <code>Path</code>, <code>Crc</code> and <code>Offset</code> properties in the <code>Parameters</code> property. If you do this, you likely will not want to call the Complete method, as you will want the original method to still be called.</p>
<p>An important additional way to subscribe to the prefix asset bundle loading operations are through the method <code>RegisterAsyncAndSyncAssetBundleLoadingHook( int priority, Action&lt;IAssetBundleLoadingContext&gt; action )</code>. This method will handle both async and sync asset bundle loading operations. The <code>IAssetLoadingContext</code> is an interface implemented by both the <code>AssetBundleLoadingContext</code> and <code>AsyncAssetBundleLoadingContext</code>.</p>
<p>Do note, that if you want to use this method you must first call the method <code>EnableSyncOverAsyncAssetLoads()</code> to enable the hooks required for this to work.</p>
<h3 id="about-recursion">About Recursion</h3>
<p>As you may have noticed, all of the context classes shown in the previous sections had a method called <code>DisableRecursion</code> and that there is a method called <code>DisableRecursionPermanently</code> directly on the <code>ResourceRedirection</code> class.</p>
<p>The purpose of these method is, as it name states, to disable recursion. That only leaves the question, when does recursion occur?</p>
<p>Recursion will happen anytime you try to load an asset/resource/asset bundle from within your callback using the <code>AssetBundle</code> or <code>Resources</code> API. Essentially, what it means is that all callbacks (except the one loading the resource) will get a chance to modify the resource that is being loaded by your callback.</p>
<p>This may not always be desirable, so if you call the method <code>DisableRecursion</code> <em>before</em> you load your resource, this recursive behaviour is disabled. In many other cases, this behaviour is very desirable because it means that it is less important to set the <em>correct</em> priority, whatever that may be.</p>
<p>Recursion has an important side effect for other prefix/postfix callbacks, and that is that they will always be called if you make a recursive load call in your callback, even if you indicate through the <code>Complete</code> method that they should not be called. So if, in your scenario, it is important to avoid this, you must disable recursion.</p>
<p><code>DisableRecursionPermanently</code> disables recursion permanently for all subscribers to the ResourceRedirection API no matter who calls it. This is a game-wide setting that should be decided upon between plugin developers rather than by the hand of the individual.</p>
<p>These options exists only because it is not currently known whether or not having recursion enabled gives the best experience to plugin developers.</p>
<h3 id="implementing-an-asset-redirector">Implementing an Asset Redirector</h3>
<p>Here&rsquo;s an example of how a resource redirection may be implemented to hook all <code>Texture2D</code> objects loaded through the <code>AssetBundle</code> API:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TextureReplacementPlugin</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">void</span> <span class="n">Awake</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ResourceRedirection</span><span class="p">.</span><span class="n">RegisterAssetLoadedHook</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">behaviour</span><span class="p">:</span> <span class="n">HookBehaviour</span><span class="p">.</span><span class="n">OneCallbackPerResourceLoaded</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">priority</span><span class="p">:</span> <span class="m">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">action</span><span class="p">:</span> <span class="n">AssetLoaded</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">AssetLoaded</span><span class="p">(</span> <span class="n">AssetLoadedContext</span> <span class="n">context</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span> <span class="n">context</span><span class="p">.</span><span class="n">Asset</span> <span class="k">is</span> <span class="n">Texture2D</span> <span class="n">texture2d</span> <span class="p">)</span> <span class="c1">// also acts as a null check</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// TODO: Modify, replace or dump the texture</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">            <span class="n">context</span><span class="p">.</span><span class="n">Asset</span> <span class="p">=</span> <span class="n">texture2d</span><span class="p">;</span> <span class="c1">// only need to update the reference if you created a new texture</span>
</span></span><span class="line"><span class="cl">            <span class="n">context</span><span class="p">.</span><span class="n">Complete</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">skipRemainingPostfixes</span><span class="p">:</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="implemting-an-assetbundle-redirector">Implemting an AssetBundle Redirector</h3>
<p>Here&rsquo;s an example of how a resource redirection may be implemented to redirect non-existing resources to a seperate &lsquo;mods&rsquo; directory.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">AssetBundleRedirectorPlugin</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">void</span> <span class="n">Awake</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ResourceRedirection</span><span class="p">.</span><span class="n">RegisterAssetBundleLoadingHook</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">priority</span><span class="p">:</span> <span class="m">1000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">action</span><span class="p">:</span> <span class="n">AssetBundleLoading</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">ResourceRedirection</span><span class="p">.</span><span class="n">RegisterAsyncAssetBundleLoadingHook</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">priority</span><span class="p">:</span> <span class="m">1000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">action</span><span class="p">:</span> <span class="n">AsyncAssetBundleLoading</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">AssetBundleLoading</span><span class="p">(</span> <span class="n">AssetBundleLoadingContext</span> <span class="n">context</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span> <span class="p">!</span><span class="n">File</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span> <span class="n">context</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">Path</span> <span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// the game is trying to load a path that does not exist, lets redirect to our own resources</span>
</span></span><span class="line"><span class="cl">		    
</span></span><span class="line"><span class="cl">            <span class="c1">// obtain different resource path</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">normalizedPath</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">GetNormalizedPath</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">modFolderPath</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="n">Combine</span><span class="p">(</span> <span class="s">&#34;mods&#34;</span><span class="p">,</span> <span class="n">normalizedPath</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">		    
</span></span><span class="line"><span class="cl">            <span class="c1">// if the path exists, let&#39;s load that instead</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span> <span class="n">File</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span> <span class="n">modFolderPath</span> <span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="kt">var</span> <span class="n">bundle</span> <span class="p">=</span> <span class="n">AssetBundle</span><span class="p">.</span><span class="n">LoadFromFile</span><span class="p">(</span> <span class="n">modFolderPath</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">		    
</span></span><span class="line"><span class="cl">                <span class="n">context</span><span class="p">.</span><span class="n">Bundle</span> <span class="p">=</span> <span class="n">bundle</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">context</span><span class="p">.</span><span class="n">Complete</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="n">skipRemainingPrefixes</span><span class="p">:</span> <span class="k">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">skipOriginalCall</span><span class="p">:</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">AsyncAssetBundleLoading</span><span class="p">(</span> <span class="n">AsyncAssetBundleLoadingContext</span> <span class="n">context</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span> <span class="p">!</span><span class="n">File</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span> <span class="n">context</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">Path</span> <span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// the game is trying to load a path that does not exist, lets redirect to our own resources</span>
</span></span><span class="line"><span class="cl">		    
</span></span><span class="line"><span class="cl">            <span class="c1">// obtain different resource path</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">normalizedPath</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">GetNormalizedPath</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">modFolderPath</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="n">Combine</span><span class="p">(</span> <span class="s">&#34;mods&#34;</span><span class="p">,</span> <span class="n">normalizedPath</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">		    
</span></span><span class="line"><span class="cl">            <span class="c1">// if the path exists, let&#39;s load that instead</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span> <span class="n">File</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span> <span class="n">modFolderPath</span> <span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="kt">var</span> <span class="n">request</span> <span class="p">=</span> <span class="n">AssetBundle</span><span class="p">.</span><span class="n">LoadFromFileAsync</span><span class="p">(</span> <span class="n">modFolderPath</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">		    
</span></span><span class="line"><span class="cl">                <span class="n">context</span><span class="p">.</span><span class="n">Request</span> <span class="p">=</span> <span class="n">request</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">context</span><span class="p">.</span><span class="n">Complete</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="n">skipRemainingPrefixes</span><span class="p">:</span> <span class="k">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">skipOriginalCall</span><span class="p">:</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Here&rsquo;s a smart way to implement the same thing, by having a single method that hooks both the synchronous and asynchronous method at the same time:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">AssetBundleRedirectorSyncOverAsyncPlugin</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">void</span> <span class="n">Awake</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ResourceRedirection</span><span class="p">.</span><span class="n">EnableSyncOverAsyncAssetLoads</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">        <span class="n">ResourceRedirection</span><span class="p">.</span><span class="n">RegisterAsyncAndSyncAssetBundleLoadingHook</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">priority</span><span class="p">:</span> <span class="m">1000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">action</span><span class="p">:</span> <span class="n">AssetBundleLoading</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">AssetBundleLoading</span><span class="p">(</span> <span class="n">IAssetBundleLoadingContext</span> <span class="n">context</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span> <span class="p">!</span><span class="n">File</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span> <span class="n">context</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">Path</span> <span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// the game is trying to load a path that does not exist, lets redirect to our own resources</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">            <span class="c1">// obtain different resource path</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">normalizedPath</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">GetNormalizedPath</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">modFolderPath</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="n">Combine</span><span class="p">(</span> <span class="s">&#34;mods&#34;</span><span class="p">,</span> <span class="n">normalizedPath</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">            <span class="c1">// if the path exists, let&#39;s load that instead</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span> <span class="n">File</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span> <span class="n">modFolderPath</span> <span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="kt">var</span> <span class="n">bundle</span> <span class="p">=</span> <span class="n">AssetBundle</span><span class="p">.</span><span class="n">LoadFromFile</span><span class="p">(</span> <span class="n">modFolderPath</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">                <span class="n">context</span><span class="p">.</span><span class="n">Bundle</span> <span class="p">=</span> <span class="n">bundle</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">context</span><span class="p">.</span><span class="n">Complete</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="n">skipRemainingPrefixes</span><span class="p">:</span> <span class="k">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">skipOriginalCall</span><span class="p">:</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>While this is clean it causes all asset bundles to be loaded synchronously, potentially locking up the game causing FPS lag. Another approach that also handles that could look like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">SmartAssetBundleRedirectorSyncOverAsyncPlugin</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">void</span> <span class="n">Awake</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ResourceRedirection</span><span class="p">.</span><span class="n">EnableSyncOverAsyncAssetLoads</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">        <span class="n">ResourceRedirection</span><span class="p">.</span><span class="n">RegisterAsyncAndSyncAssetBundleLoadingHook</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">priority</span><span class="p">:</span> <span class="m">1000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">action</span><span class="p">:</span> <span class="n">AssetBundleLoading</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">AssetBundleLoading</span><span class="p">(</span> <span class="n">IAssetBundleLoadingContext</span> <span class="n">context</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span> <span class="p">!</span><span class="n">File</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span> <span class="n">context</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">Path</span> <span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// the game is trying to load a path that does not exist, lets redirect to our own resources</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">            <span class="c1">// obtain different resource path</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">normalizedPath</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">GetNormalizedPath</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">modFolderPath</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="n">Combine</span><span class="p">(</span> <span class="s">&#34;mods&#34;</span><span class="p">,</span> <span class="n">normalizedPath</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">            <span class="c1">// if the path exists, let&#39;s load that instead</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span> <span class="n">File</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span> <span class="n">modFolderPath</span> <span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span><span class="p">(</span> <span class="n">context</span> <span class="k">is</span> <span class="n">AsyncAssetBundleLoadingContext</span> <span class="n">asyncContext</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">request</span> <span class="p">=</span> <span class="n">AssetBundle</span><span class="p">.</span><span class="n">LoadFromFileAsync</span><span class="p">(</span> <span class="n">modFolderPath</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">asyncContext</span><span class="p">.</span><span class="n">Request</span> <span class="p">=</span> <span class="n">request</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">bundle</span> <span class="p">=</span> <span class="n">AssetBundle</span><span class="p">.</span><span class="n">LoadFromFile</span><span class="p">(</span> <span class="n">modFolderPath</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">context</span><span class="p">.</span><span class="n">Bundle</span> <span class="p">=</span> <span class="n">bundle</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">                <span class="n">context</span><span class="p">.</span><span class="n">Complete</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="n">skipRemainingPrefixes</span><span class="p">:</span> <span class="k">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">skipOriginalCall</span><span class="p">:</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Here&rsquo;s the redirector that is activated if the <code>EmulateAssetBundles</code> option is enabled in the plugin, which allows loading asset bundles from a different location than the game is requesting the bundle from:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Creates an asset bundle hook that attempts to load asset bundles in the emulation directory</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// over the default asset bundles if they exist.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;param name=&#34;hookPriority&#34;&gt;Priority of the hook.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;param name=&#34;emulationDirectory&#34;&gt;The directory to look for the asset bundles in.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">EnableEmulateAssetBundles</span><span class="p">(</span> <span class="kt">int</span> <span class="n">hookPriority</span><span class="p">,</span> <span class="kt">string</span> <span class="n">emulationDirectory</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">RegisterAssetBundleLoadingHook</span><span class="p">(</span> <span class="n">hookPriority</span><span class="p">,</span> <span class="n">ctx</span> <span class="p">=&gt;</span> <span class="n">HandleAssetBundleEmulation</span><span class="p">(</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">SetBundle</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">RegisterAsyncAssetBundleLoadingHook</span><span class="p">(</span> <span class="n">hookPriority</span><span class="p">,</span> <span class="n">ctx</span> <span class="p">=&gt;</span> <span class="n">HandleAssetBundleEmulation</span><span class="p">(</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">SetRequest</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">		    
</span></span><span class="line"><span class="cl">    <span class="c1">// define base callback</span>
</span></span><span class="line"><span class="cl">    <span class="k">void</span> <span class="n">HandleAssetBundleEmulation</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span> <span class="n">T</span> <span class="n">context</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="n">changeBundle</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">where</span> <span class="n">T</span> <span class="p">:</span> <span class="n">IAssetBundleLoadingContext</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span> <span class="n">context</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">LoadType</span> <span class="p">==</span> <span class="n">AssetBundleLoadType</span><span class="p">.</span><span class="n">LoadFromFile</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">normalizedPath</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">GetNormalizedPath</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">emulatedPath</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="n">Combine</span><span class="p">(</span> <span class="n">emulationDirectory</span><span class="p">,</span> <span class="n">normalizedPath</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span> <span class="n">File</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span> <span class="n">emulatedPath</span> <span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">changeBundle</span><span class="p">(</span> <span class="n">context</span><span class="p">,</span> <span class="n">emulatedPath</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">		    
</span></span><span class="line"><span class="cl">                <span class="n">context</span><span class="p">.</span><span class="n">Complete</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="n">skipRemainingPrefixes</span><span class="p">:</span> <span class="k">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">skipOriginalCall</span><span class="p">:</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">		    
</span></span><span class="line"><span class="cl">    <span class="c1">// synchronous specific code</span>
</span></span><span class="line"><span class="cl">    <span class="k">void</span> <span class="n">SetBundle</span><span class="p">(</span> <span class="n">AssetBundleLoadingContext</span> <span class="n">context</span><span class="p">,</span> <span class="kt">string</span> <span class="n">path</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">context</span><span class="p">.</span><span class="n">Bundle</span> <span class="p">=</span> <span class="n">AssetBundle</span><span class="p">.</span><span class="n">LoadFromFile</span><span class="p">(</span> <span class="n">path</span><span class="p">,</span> <span class="n">context</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">Crc</span><span class="p">,</span> <span class="n">context</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">Offset</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">		    
</span></span><span class="line"><span class="cl">    <span class="c1">// asynchronous specific code</span>
</span></span><span class="line"><span class="cl">    <span class="k">void</span> <span class="n">SetRequest</span><span class="p">(</span> <span class="n">AsyncAssetBundleLoadingContext</span> <span class="n">context</span><span class="p">,</span> <span class="kt">string</span> <span class="n">path</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">context</span><span class="p">.</span><span class="n">Request</span> <span class="p">=</span> <span class="n">AssetBundle</span><span class="p">.</span><span class="n">LoadFromFileAsync</span><span class="p">(</span> <span class="n">path</span><span class="p">,</span> <span class="n">context</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">Crc</span><span class="p">,</span> <span class="n">context</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">Offset</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Here&rsquo;s the redirector that is activated if the <code>RedirectMissingAssetBundles</code> option is enabled in the plugin, which essentially simply loads an empty asset bundle if an asset bundle cannot be found:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Creates an asset bundle hook that redirects asset bundles loads to an empty</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// asset bundle if the file that is being loaded does not exist.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;param name=&#34;hookPriority&#34;&gt;Priority of the hook.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">EnableRedirectMissingAssetBundlesToEmptyAssetBundle</span><span class="p">(</span> <span class="kt">int</span> <span class="n">hookPriority</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">RegisterAssetBundleLoadingHook</span><span class="p">(</span> <span class="n">hookPriority</span><span class="p">,</span> <span class="n">ctx</span> <span class="p">=&gt;</span> <span class="n">HandleMissingBundle</span><span class="p">(</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">SetBundle</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">RegisterAsyncAssetBundleLoadingHook</span><span class="p">(</span> <span class="n">hookPriority</span><span class="p">,</span> <span class="n">ctx</span> <span class="p">=&gt;</span> <span class="n">HandleMissingBundle</span><span class="p">(</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">SetRequest</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">    <span class="c1">// define base callback</span>
</span></span><span class="line"><span class="cl">    <span class="k">void</span> <span class="n">HandleMissingBundle</span><span class="p">&lt;</span><span class="n">TContext</span><span class="p">&gt;(</span> <span class="n">TContext</span> <span class="n">context</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">TContext</span><span class="p">,</span> <span class="kt">byte</span><span class="p">[]&gt;</span> <span class="n">changeBundle</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">where</span> <span class="n">TContext</span> <span class="p">:</span> <span class="n">IAssetBundleLoadingContext</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span> <span class="n">context</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">LoadType</span> <span class="p">==</span> <span class="n">AssetBundleLoadType</span><span class="p">.</span><span class="n">LoadFromFile</span>
</span></span><span class="line"><span class="cl">            <span class="p">&amp;&amp;</span> <span class="p">!</span><span class="n">File</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span> <span class="n">context</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">Path</span> <span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">buffer</span> <span class="p">=</span> <span class="n">Properties</span><span class="p">.</span><span class="n">Resources</span><span class="p">.</span><span class="n">empty</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">CabHelper</span><span class="p">.</span><span class="n">RandomizeCab</span><span class="p">(</span> <span class="n">buffer</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">            <span class="n">changeBundle</span><span class="p">(</span> <span class="n">context</span><span class="p">,</span> <span class="n">buffer</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">            <span class="n">context</span><span class="p">.</span><span class="n">Complete</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">skipRemainingPrefixes</span><span class="p">:</span> <span class="k">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">skipOriginalCall</span><span class="p">:</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">            <span class="n">XuaLogger</span><span class="p">.</span><span class="n">ResourceRedirector</span><span class="p">.</span><span class="n">Warn</span><span class="p">(</span> <span class="s">&#34;Tried to load non-existing asset bundle: &#34;</span> <span class="p">+</span> <span class="n">context</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">Path</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">    <span class="c1">// synchronous specific code</span>
</span></span><span class="line"><span class="cl">    <span class="k">void</span> <span class="n">SetBundle</span><span class="p">(</span> <span class="n">AssetBundleLoadingContext</span> <span class="n">context</span><span class="p">,</span> <span class="kt">byte</span><span class="p">[]</span> <span class="n">assetBundleData</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">bundle</span> <span class="p">=</span> <span class="n">AssetBundle</span><span class="p">.</span><span class="n">LoadFromMemory</span><span class="p">(</span> <span class="n">assetBundleData</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">context</span><span class="p">.</span><span class="n">Bundle</span> <span class="p">=</span> <span class="n">bundle</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">    <span class="c1">// asynchronous specific code</span>
</span></span><span class="line"><span class="cl">    <span class="k">void</span> <span class="n">SetRequest</span><span class="p">(</span> <span class="n">AsyncAssetBundleLoadingContext</span> <span class="n">context</span><span class="p">,</span> <span class="kt">byte</span><span class="p">[]</span> <span class="n">assetBundleData</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">request</span> <span class="p">=</span> <span class="n">AssetBundle</span><span class="p">.</span><span class="n">LoadFromMemoryAsync</span><span class="p">(</span> <span class="n">assetBundleData</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">context</span><span class="p">.</span><span class="n">Request</span> <span class="p">=</span> <span class="n">request</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="implementing-an-assetresource-handler-auto-translator">Implementing an Asset/Resource Handler (Auto Translator)</h3>
<p>This section shows how to implement an asset/resource redirector that respects the Auto Translator configuration.</p>
<p>The <code>XUnity.AutoTranslator.Core.Plugin.dll</code> assembly has a base class that can be used to implement a plugin that dumps resources for the purposes of translation.</p>
<p>This class simply hooks the postfix to the load of assets from the <code>AssetBundle</code> and the <code>Resources</code> API. Here&rsquo;s how the base class looks:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Base implementation of resource redirect handler that takes care of the plumming for a</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// resource redirector that is interested in either updating or dumping redirected resources.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;typeparam name=&#34;TAsset&#34;&gt;The type of asset being redirected.&lt;/typeparam&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">AssetLoadedHandlerBaseV2</span><span class="p">&lt;</span><span class="n">TAsset</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">where</span> <span class="n">TAsset</span> <span class="p">:</span> <span class="n">UnityEngine</span><span class="p">.</span><span class="n">Object</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Method invoked when an asset should be updated or replaced.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;calculatedModificationPath&#34;&gt;This is the modification path calculated in the CalculateModificationFilePath method.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;asset&#34;&gt;The asset to be updated or replaced.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;context&#34;&gt;This is the context containing all relevant information for the resource redirection event.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;returns&gt;A bool indicating if the event should be considered handled.&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="k">abstract</span> <span class="kt">bool</span> <span class="n">ReplaceOrUpdateAsset</span><span class="p">(</span> <span class="kt">string</span> <span class="n">calculatedModificationPath</span><span class="p">,</span> <span class="k">ref</span> <span class="n">TAsset</span> <span class="n">asset</span><span class="p">,</span> <span class="n">IAssetOrResourceLoadedContext</span> <span class="n">context</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Method invoked when an asset should be dumped.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;calculatedModificationPath&#34;&gt;This is the modification path calculated in the CalculateModificationFilePath method.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;asset&#34;&gt;The asset to be updated or replaced.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;context&#34;&gt;This is the context containing all relevant information for the resource redirection event.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;returns&gt;A bool indicating if the event should be considered handled.&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="k">abstract</span> <span class="kt">bool</span> <span class="n">DumpAsset</span><span class="p">(</span> <span class="kt">string</span> <span class="n">calculatedModificationPath</span><span class="p">,</span> <span class="n">TAsset</span> <span class="n">asset</span><span class="p">,</span> <span class="n">IAssetOrResourceLoadedContext</span> <span class="n">context</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Method invoked when a new resource event is fired to calculate a unique path for the resource.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;asset&#34;&gt;The asset to be updated or replaced.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;context&#34;&gt;This is the context containing all relevant information for the resource redirection event.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;returns&gt;A string uniquely representing a path for the redirected resource.&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="k">abstract</span> <span class="kt">string</span> <span class="n">CalculateModificationFilePath</span><span class="p">(</span> <span class="n">TAsset</span> <span class="n">asset</span><span class="p">,</span> <span class="n">IAssetOrResourceLoadedContext</span> <span class="n">context</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Method to be invoked to indicate if the asset should be handled or not.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;asset&#34;&gt;The asset to be updated or replaced.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;context&#34;&gt;This is the context containing all relevant information for the resource redirection event.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;returns&gt;A bool indicating if the asset should be handled.&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="k">abstract</span> <span class="kt">bool</span> <span class="n">ShouldHandleAsset</span><span class="p">(</span> <span class="n">TAsset</span> <span class="n">asset</span><span class="p">,</span> <span class="n">IAssetOrResourceLoadedContext</span> <span class="n">context</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The Auto Translation includes one default implementation of this class for TextAssets. It looks like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">internal</span> <span class="k">class</span> <span class="nc">TextAssetLoadedHandler</span> <span class="p">:</span> <span class="n">AssetLoadedHandlerBaseV2</span><span class="p">&lt;</span><span class="n">TextAsset</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="k">override</span> <span class="kt">string</span> <span class="n">CalculateModificationFilePath</span><span class="p">(</span> <span class="n">TextAsset</span> <span class="n">asset</span><span class="p">,</span> <span class="n">IAssetOrResourceLoadedContext</span> <span class="n">context</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">context</span><span class="p">.</span><span class="n">GetPreferredFilePath</span><span class="p">(</span> <span class="n">asset</span><span class="p">,</span> <span class="s">&#34;.txt&#34;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="k">override</span> <span class="kt">bool</span> <span class="n">DumpAsset</span><span class="p">(</span> <span class="kt">string</span> <span class="n">calculatedModificationPath</span><span class="p">,</span> <span class="n">TextAsset</span> <span class="n">asset</span><span class="p">,</span> <span class="n">IAssetOrResourceLoadedContext</span> <span class="n">context</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Directory</span><span class="p">.</span><span class="n">CreateDirectory</span><span class="p">(</span> <span class="k">new</span> <span class="n">FileInfo</span><span class="p">(</span> <span class="n">calculatedModificationPath</span> <span class="p">).</span><span class="n">Directory</span><span class="p">.</span><span class="n">FullName</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">File</span><span class="p">.</span><span class="n">WriteAllBytes</span><span class="p">(</span> <span class="n">calculatedModificationPath</span><span class="p">,</span> <span class="n">asset</span><span class="p">.</span><span class="n">bytes</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="k">override</span> <span class="kt">bool</span> <span class="n">ReplaceOrUpdateAsset</span><span class="p">(</span> <span class="kt">string</span> <span class="n">calculatedModificationPath</span><span class="p">,</span> <span class="k">ref</span> <span class="n">TextAsset</span> <span class="n">asset</span><span class="p">,</span> <span class="n">IAssetOrResourceLoadedContext</span> <span class="n">context</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">RedirectedResource</span> <span class="n">file</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">files</span> <span class="p">=</span> <span class="n">RedirectedDirectory</span><span class="p">.</span><span class="n">GetFile</span><span class="p">(</span> <span class="n">calculatedModificationPath</span> <span class="p">).</span><span class="n">ToList</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span> <span class="n">files</span><span class="p">.</span><span class="n">Count</span> <span class="p">==</span> <span class="m">0</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">		    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span> <span class="n">files</span><span class="p">.</span><span class="n">Count</span> <span class="p">&gt;</span> <span class="m">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">XuaLogger</span><span class="p">.</span><span class="n">AutoTranslator</span><span class="p">.</span><span class="n">Warn</span><span class="p">(</span> <span class="s">&#34;Found more than one resource file in the same path: &#34;</span> <span class="p">+</span> <span class="n">calculatedModificationPath</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">		    
</span></span><span class="line"><span class="cl">            <span class="n">file</span> <span class="p">=</span> <span class="n">files</span><span class="p">.</span><span class="n">FirstOrDefault</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span> <span class="n">file</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">using</span><span class="p">(</span> <span class="kt">var</span> <span class="n">stream</span> <span class="p">=</span> <span class="n">file</span><span class="p">.</span><span class="n">OpenStream</span><span class="p">()</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="kt">var</span> <span class="n">data</span> <span class="p">=</span> <span class="n">stream</span><span class="p">.</span><span class="n">ReadFully</span><span class="p">(</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">stream</span><span class="p">.</span><span class="n">Length</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="kt">var</span> <span class="n">text</span> <span class="p">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetString</span><span class="p">(</span> <span class="n">data</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">		    
</span></span><span class="line"><span class="cl">                <span class="kt">var</span> <span class="n">ext</span> <span class="p">=</span> <span class="n">asset</span><span class="p">.</span><span class="n">GetOrCreateExtensionData</span><span class="p">&lt;</span><span class="n">TextAssetExtensionData</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">                <span class="n">ext</span><span class="p">.</span><span class="n">Data</span> <span class="p">=</span> <span class="n">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">ext</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="n">text</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		    
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="k">override</span> <span class="kt">bool</span> <span class="n">ShouldHandleAsset</span><span class="p">(</span> <span class="n">TextAsset</span> <span class="n">asset</span><span class="p">,</span> <span class="n">IAssetOrResourceLoadedContext</span> <span class="n">context</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">!</span><span class="n">context</span><span class="p">.</span><span class="n">HasReferenceBeenRedirectedBefore</span><span class="p">(</span> <span class="n">asset</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Note that when accessing the resource file, we do not use the standard file API to obtain a stream to get the data in the file. Instead we use the RedirectedDirectory facade. This will also look in ZIP files and simply treat a ZIP file as a directory when making the lookup.</p>
<p>Another examples of an implementation of this class would be for Koikatsu that enables replacing its custom resources:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">ScenarioDataResourceRedirector</span> <span class="p">:</span> <span class="n">AssetLoadedHandlerBaseV2</span><span class="p">&lt;</span><span class="n">ScenarioData</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="n">ScenarioDataResourceRedirector</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">CheckDirectory</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">protected</span> <span class="k">override</span> <span class="kt">string</span> <span class="n">CalculateModificationFilePath</span><span class="p">(</span> <span class="n">ScenarioData</span> <span class="n">asset</span><span class="p">,</span> <span class="n">IAssetOrResourceLoadedContext</span> <span class="n">context</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="n">context</span><span class="p">.</span><span class="n">GetPreferredFilePathWithCustomFileName</span><span class="p">(</span> <span class="n">asset</span><span class="p">,</span> <span class="k">null</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">         <span class="p">.</span><span class="n">Replace</span><span class="p">(</span> <span class="s">&#34;.unity3d&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">protected</span> <span class="k">override</span> <span class="kt">bool</span> <span class="n">DumpAsset</span><span class="p">(</span> <span class="kt">string</span> <span class="n">calculatedModificationPath</span><span class="p">,</span> <span class="n">ScenarioData</span> <span class="n">asset</span><span class="p">,</span> <span class="n">IAssetOrResourceLoadedContext</span> <span class="n">context</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kt">var</span> <span class="n">defaultTranslationFile</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="n">Combine</span><span class="p">(</span> <span class="n">calculatedModificationPath</span><span class="p">,</span> <span class="s">&#34;translation.txt&#34;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="kt">var</span> <span class="n">cache</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SimpleTextTranslationCache</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">         <span class="n">file</span><span class="p">:</span> <span class="n">defaultTranslationFile</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">loadTranslationsInFile</span><span class="p">:</span> <span class="k">false</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">foreach</span><span class="p">(</span> <span class="kt">var</span> <span class="n">param</span> <span class="k">in</span> <span class="n">asset</span><span class="p">.</span><span class="n">list</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="k">if</span><span class="p">(</span> <span class="n">param</span><span class="p">.</span><span class="n">Command</span> <span class="p">==</span> <span class="n">Command</span><span class="p">.</span><span class="n">Text</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span><span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">param</span><span class="p">.</span><span class="n">Args</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="kt">var</span> <span class="n">key</span> <span class="p">=</span> <span class="n">param</span><span class="p">.</span><span class="n">Args</span><span class="p">[</span> <span class="n">i</span> <span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">               <span class="k">if</span><span class="p">(</span> <span class="p">!</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span> <span class="n">key</span> <span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="n">LanguageHelper</span><span class="p">.</span><span class="n">IsTranslatable</span><span class="p">(</span> <span class="n">key</span> <span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">               <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="n">cache</span><span class="p">.</span><span class="n">AddTranslationToCache</span><span class="p">(</span> <span class="n">key</span><span class="p">,</span> <span class="n">key</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">               <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">protected</span> <span class="k">override</span> <span class="kt">bool</span> <span class="n">ReplaceOrUpdateAsset</span><span class="p">(</span> <span class="kt">string</span> <span class="n">calculatedModificationPath</span><span class="p">,</span> <span class="k">ref</span> <span class="n">ScenarioData</span> <span class="n">asset</span><span class="p">,</span> <span class="n">IAssetOrResourceLoadedContext</span> <span class="n">context</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kt">var</span> <span class="n">defaultTranslationFile</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="n">Combine</span><span class="p">(</span> <span class="n">calculatedModificationPath</span><span class="p">,</span> <span class="s">&#34;translation.txt&#34;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="kt">var</span> <span class="n">redirectedResources</span> <span class="p">=</span> <span class="n">RedirectedDirectory</span><span class="p">.</span><span class="n">GetFilesInDirectory</span><span class="p">(</span> <span class="n">calculatedModificationPath</span><span class="p">,</span> <span class="s">&#34;.txt&#34;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="kt">var</span> <span class="n">streams</span> <span class="p">=</span> <span class="n">redirectedResources</span><span class="p">.</span><span class="n">Select</span><span class="p">(</span> <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">OpenStream</span><span class="p">()</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="kt">var</span> <span class="n">cache</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SimpleTextTranslationCache</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">         <span class="n">outputFile</span><span class="p">:</span> <span class="n">defaultTranslationFile</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">inputStreams</span><span class="p">:</span> <span class="n">streams</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">allowTranslationOverride</span><span class="p">:</span> <span class="k">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">closeStreams</span><span class="p">:</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">foreach</span><span class="p">(</span> <span class="kt">var</span> <span class="n">param</span> <span class="k">in</span> <span class="n">asset</span><span class="p">.</span><span class="n">list</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="k">if</span><span class="p">(</span> <span class="n">param</span><span class="p">.</span><span class="n">Command</span> <span class="p">==</span> <span class="n">Command</span><span class="p">.</span><span class="n">Text</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span><span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">param</span><span class="p">.</span><span class="n">Args</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="kt">var</span> <span class="n">key</span> <span class="p">=</span> <span class="n">param</span><span class="p">.</span><span class="n">Args</span><span class="p">[</span> <span class="n">i</span> <span class="p">];</span>
</span></span><span class="line"><span class="cl">               <span class="k">if</span><span class="p">(</span> <span class="p">!</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span> <span class="n">key</span> <span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">               <span class="p">{</span>
</span></span><span class="line"><span class="cl">                  <span class="k">if</span><span class="p">(</span> <span class="n">cache</span><span class="p">.</span><span class="n">TryGetTranslation</span><span class="p">(</span> <span class="n">key</span><span class="p">,</span> <span class="k">true</span><span class="p">,</span> <span class="k">out</span> <span class="kt">var</span> <span class="n">translated</span> <span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">                  <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="n">param</span><span class="p">.</span><span class="n">Args</span><span class="p">[</span> <span class="n">i</span> <span class="p">]</span> <span class="p">=</span> <span class="n">translated</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">                  <span class="k">else</span> <span class="k">if</span><span class="p">(</span> <span class="n">AutoTranslatorSettings</span><span class="p">.</span><span class="n">IsDumpingRedirectedResourcesEnabled</span> <span class="p">&amp;&amp;</span> <span class="n">LanguageHelper</span><span class="p">.</span><span class="n">IsTranslatable</span><span class="p">(</span> <span class="n">key</span> <span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">                  <span class="p">{</span>
</span></span><span class="line"><span class="cl">                     <span class="n">cache</span><span class="p">.</span><span class="n">AddTranslationToCache</span><span class="p">(</span> <span class="n">key</span><span class="p">,</span> <span class="n">key</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">               <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">protected</span> <span class="k">override</span> <span class="kt">bool</span> <span class="n">ShouldHandleAsset</span><span class="p">(</span> <span class="n">ScenarioData</span> <span class="n">asset</span><span class="p">,</span> <span class="n">IAssetOrResourceLoadedContext</span> <span class="n">context</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="p">!</span><span class="n">context</span><span class="p">.</span><span class="n">HasReferenceBeenRedirectedBefore</span><span class="p">(</span> <span class="n">asset</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Once you have implemented one of these classes, you just need to instantiate it and it will do it&rsquo;s magic.</p>

</section>


    <footer class="article-footer">
    

    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2022 - 
        
        2023 ÁæΩËÇøÁöÑ‰∏™‰∫∫ÂçöÂÆ¢
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        ‰∏ªÈ¢ò <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> Áî± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> ËÆæËÆ°
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
